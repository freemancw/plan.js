<HEAD>
<TITLE>Motion Strategy Library</TITLE>
</HEAD>

<body bgcolor="#ffffff">

<center><img src="msl.jpg"></center>

<p>


<!-- Generated by Doxygen 1.2.2 on Wed Aug 29 23:26:45 2001 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>renderglobj.C</h1><a href="renderglobj_C.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">//----------------------------------------------------------------------</font>
00002 <font class="comment">//               The Motion Strategy Library (MSL)</font>
00003 <font class="comment">//----------------------------------------------------------------------</font>
00004 <font class="comment">//</font>
00005 <font class="comment">// Copyright (c) 1998-2001 Iowa State University and Steve LaValle.  </font>
00006 <font class="comment">// All Rights Reserved.</font>
00007 <font class="comment">// </font>
00008 <font class="comment">// Permission to use, copy, and distribute this software and its </font>
00009 <font class="comment">// documentation is hereby granted free of charge, provided that </font>
00010 <font class="comment">// (1) it is not a component of a commercial product, and </font>
00011 <font class="comment">// (2) this notice appears in all copies of the software and</font>
00012 <font class="comment">//     related documentation. </font>
00013 <font class="comment">// </font>
00014 <font class="comment">// Iowa State University and the author make no representations</font>
00015 <font class="comment">// about the suitability or fitness of this software for any purpose.  </font>
00016 <font class="comment">// It is provided "as is" without express or implied warranty.</font>
00017 <font class="comment">//----------------------------------------------------------------------</font>
00018 
00019 <font class="comment">// This file was written by Peng Cheng (chp@cs.iastate.edu)</font>
00020 
00021 <font class="preprocessor">#include "<a class="code" href="renderglobj_h.html">renderglobj.h</a>"</font>
00022 <font class="preprocessor">#include "<a class="code" href="defs_h.html">defs.h</a>"</font>
00023 
00024 
00025 <font class="comment">//****!!!!!!!!!!!!!!!!!!!!!!!!!!!! -- came from matrix.C -- 1/5/01</font>
<a name="l00026"></a><a class="code" href="renderglobj_C.html#a4">00026</a> <font class="keywordtype">void</font> <a class="code" href="renderglobj_C.html#a4">rotate_x_matrix</a>(<font class="keywordtype">double</font> sita, <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; m)<font class="keyword">
</font>00027 <font class="keyword"></font>{
00028   m(0, 0)=1.0;  m(0,1)=0.0;   m(0,2)=0.0;    m(0,3)=0.0;
00029   m(1,0)=0.0;  m(1,1)=cos(sita);   m(1,2)=-sin(sita);    m(1,3)=0.0;
00030   m(2,0)=0.0;  m(2,1)=sin(sita);   m(2,2)=cos(sita);    m(2,3)=0.0;
00031   m(3,0)=0.0;  m(3,1)=0.0;   m(3,2)=0.0;    m(3,3)=1.0;
00032 }
00033 
<a name="l00034"></a><a class="code" href="renderglobj_C.html#a5">00034</a> <font class="keywordtype">void</font> <a class="code" href="renderglobj_C.html#a5">rotate_y_matrix</a>(<font class="keywordtype">double</font> sita, <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; m)<font class="keyword">
</font>00035 <font class="keyword"></font>{
00036   m(0,0)=cos(sita);  m(0,1)=0.0;   m(0,2)=sin(sita);    m(0,3)=0.0;
00037   m(1,0)=0.0;  m(1,1)=1.0;   m(1,2)=0.0;    m(1,3)=0.0;
00038   m(2,0)=-sin(sita);  m(2,1)=0.0;   m(2,2)=cos(sita);    m(2,3)=0.0;
00039   m(3,0)=0.0;  m(3,1)=0.0;   m(3,2)=0.0;    m(3,3)=1.0;
00040 }
00041 
<a name="l00042"></a><a class="code" href="renderglobj_C.html#a6">00042</a> <font class="keywordtype">void</font> <a class="code" href="renderglobj_C.html#a6">rotate_z_matrix</a>(<font class="keywordtype">double</font> sita, <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; m)<font class="keyword">
</font>00043 <font class="keyword"></font>{
00044   m(0,0)=cos(sita);  m(0,1)=-sin(sita);   m(0,2)=0.0;    m(0,3)=0.0;
00045   m(1,0)=sin(sita);  m(1,1)=cos(sita);   m(1,2)=0.0;    m(1,3)=0.0;
00046   m(2,0)=0.0;  m(2,1)=0.0;   m(2,2)=1.0;    m(2,3)=0.0;
00047   m(3,0)=0.0;  m(3,1)=0.0;   m(3,2)=0.0;    m(3,3)=1.0;
00048 }
00049 
<a name="l00050"></a><a class="code" href="renderglobj_C.html#a7">00050</a> <a class="code" href="class_MSLVector.html">MSLVector</a> <a class="code" href="renderglobj_C.html#a7">point_x_rotation</a>(<font class="keyword">const</font> <font class="keywordtype">double</font>&amp; sita, <font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; p1)<font class="keyword">
</font>00051 <font class="keyword"></font>{
00052   <a class="code" href="class_MSLVector.html">MSLVector</a> p2(3), p21(4), p11(4);
00053   <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> m(4,4);
00054 
00055   <a class="code" href="renderglobj_C.html#a4">rotate_x_matrix</a>(sita, m);
00056   p11[0] = p1[0]; 
00057   p11[1] = p1[1]; 
00058   p11[2] = p1[2]; 
00059   p11[3] = 1.0;
00060 
00061   p21 = m * p11;
00062 
00063   p2[0] = p21[0];
00064   p2[1] = p21[1];
00065   p2[2] = p21[2];
00066 
00067   <font class="keywordflow">return</font> p2;
00068 }
00069 
<a name="l00070"></a><a class="code" href="renderglobj_C.html#a8">00070</a> <a class="code" href="class_MSLVector.html">MSLVector</a> <a class="code" href="renderglobj_C.html#a8">point_y_rotation</a>(<font class="keyword">const</font> <font class="keywordtype">double</font>&amp; sita, <font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; p1)<font class="keyword">
</font>00071 <font class="keyword"></font>{
00072   <a class="code" href="class_MSLVector.html">MSLVector</a> p2(3), p21(4), p11(4);
00073   <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> m(4,4);
00074 
00075   <a class="code" href="renderglobj_C.html#a5">rotate_y_matrix</a>(sita, m);
00076   p11[0] = p1[0]; 
00077   p11[1] = p1[1]; 
00078   p11[2] = p1[2]; 
00079   p11[3] = 1.0;
00080 
00081   p21 = m * p11;
00082 
00083   p2[0] = p21[0];
00084   p2[1] = p21[1];
00085   p2[2] = p21[2];
00086 
00087   <font class="keywordflow">return</font> p2;
00088 }
00089 
<a name="l00090"></a><a class="code" href="renderglobj_C.html#a9">00090</a> <a class="code" href="class_MSLVector.html">MSLVector</a> <a class="code" href="renderglobj_C.html#a9">point_z_rotation</a>(<font class="keyword">const</font> <font class="keywordtype">double</font>&amp; sita, <font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; p1)<font class="keyword">
</font>00091 <font class="keyword"></font>{
00092   <a class="code" href="class_MSLVector.html">MSLVector</a> p2(3), p21(4), p11(4);
00093   <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> m(4,4);
00094 
00095   <a class="code" href="renderglobj_C.html#a6">rotate_z_matrix</a>(sita, m);
00096   p11[0] = p1[0]; 
00097   p11[1] = p1[1]; 
00098   p11[2] = p1[2]; 
00099   p11[3] = 1.0;
00100 
00101   p21 = m * p11;
00102 
00103   p2[0] = p21[0];
00104   p2[1] = p21[1];
00105   p2[2] = p21[2];
00106 
00107   <font class="keywordflow">return</font> p2;
00108 }
00109 
00110 
00111 
<a name="l00112"></a><a class="code" href="renderglobj_C.html#a10">00112</a> <font class="keywordtype">void</font> <a class="code" href="renderglobj_C.html#a10">crossproduct</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; v1, <font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; v2, <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; v)<font class="keyword">
</font>00113 <font class="keyword"></font>{
00114   v[0] = v1[1]*v2[2] - v1[2]*v2[1];  
00115   v[1] = v1[2]*v2[0] - v1[0]*v2[2]; 
00116   v[2] = v1[0]*v2[1] - v1[1]*v2[0];   
00117 }
00118 
00119 
<a name="l00120"></a><a class="code" href="renderglobj_C.html#a11">00120</a> <font class="keywordtype">void</font> <a class="code" href="renderglobj_C.html#a11">normalMSLVector</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; v1, <font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; v2, <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; v)<font class="keyword">
</font>00121 <font class="keyword"></font>{
00122   <a class="code" href="renderglobj_C.html#a10">crossproduct</a>(v1, v2, v);
00123   v = v.<a class="code" href="class_MSLVector.html#a15">norm</a>();
00124 }
00125 
<a name="l00126"></a><a class="code" href="renderglobj_C.html#a12">00126</a> <a class="code" href="class_MSLVector.html">MSLVector</a> <a class="code" href="renderglobj_C.html#a12">irpy</a>(<font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; R)<font class="keyword">
</font>00127 <font class="keyword"></font>{
00128   <a class="code" href="class_MSLVector.html">MSLVector</a> k(3);
00129 
00130    <font class="keywordflow">if</font> (R(2,0) == 1) {
00131      k[0] = atan2(-R(0, 1), -R(0, 2));
00132      k[1] = -PI/2.0;
00133      k[2] = 0.0;
00134    } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (R(2,0) == -1) {
00135      k[0] = atan2(R(0,1), R(0,2));
00136      k[1] = PI/2.0;
00137      k[2] = 0.0;
00138    } <font class="keywordflow">else</font> {
00139      k[0] = atan2(R(2,1), R(2,2));
00140      k[1] = atan2(-R(2,0), sqrt(R(0,0)*R(0,0) + R(1,0)*R(1,0)));
00141      k[2] = atan2(R(1,0), R(0,0));
00142    }
00143 
00144    <font class="keywordflow">return</font> k;
00145 }
00146 
<a name="l00147"></a><a class="code" href="renderglobj_C.html#a13">00147</a> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> <a class="code" href="renderglobj_C.html#a13">rpy</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; a)<font class="keyword">
</font>00148 <font class="keyword"></font>{
00149 
00150    <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> rot(4,4);
00151    <font class="keywordtype">double</font> ca, sa, cb, sb, cc, sc;
00152 
00153    ca = cos(a[0]);
00154    sa = sin(a[0]);
00155    cb = cos(a[1]);
00156    sb = sin(a[1]);
00157    cc = cos(a[2]);
00158    sc = sin(a[2]);
00159 
00160    rot(0,0) = cb*cc;
00161    rot(0,1) = sa*sb*cc-ca*sc;
00162    rot(0,2) = ca*sb*cc+sa*sc;
00163    rot(1,0) = cb*sc;
00164    rot(1,1) = sa*sb*sc+ca*cc;
00165    rot(1,2) = ca*sb*sc-sa*cc;
00166    rot(2,0) = -sb;
00167    rot(2,1) = sa*cb;
00168    rot(2,2) = ca*cb;
00169 
00170    rot(0, 3) = rot(1, 3) = rot(2, 3) = rot(3, 0) = rot(3, 1) = rot(3, 2) = 0.0;
00171    rot(3, 3) = 1.0;
00172 
00173    <font class="keywordflow">return</font> rot;
00174 
00175 }
00176 
<a name="l00177"></a><a class="code" href="renderglobj_C.html#a14">00177</a> <a class="code" href="class_MSLVector.html">MSLVector</a> <a class="code" href="renderglobj_C.html#a15">free_rotate</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; axis, <font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; v, <font class="keywordtype">double</font> sita)<font class="keyword">
</font>00178 <font class="keyword"></font>{
00179   <font class="keywordtype">double</font> rx, ry;
00180   <font class="keywordtype">double</font> diagnal_xy;
00181   <a class="code" href="class_MSLVector.html">MSLVector</a> vt(3);
00182 
00183   <font class="comment">// get the rotation angle rx around x to make the axis to be in zx plane</font>
00184   rx = atan2(axis[1], axis[2]);
00185 
00187   <font class="comment">// because diagnal_xy might be negative</font>
00188   diagnal_xy = sqrt(axis[1]*axis[1]+axis[2]*axis[2]);
00189 
00190   <font class="comment">// get the rotate angle ry around y to make the axis to be withe z axis</font>
00191   ry = atan2(axis[0], diagnal_xy);
00192 
00193   vt = v;
00194 
00195   vt = <a class="code" href="renderglobj_C.html#a7">point_x_rotation</a>(rx, vt);
00196   vt = <a class="code" href="renderglobj_C.html#a8">point_y_rotation</a>(-ry, vt);
00197 
00198   vt = <a class="code" href="renderglobj_C.html#a9">point_z_rotation</a>(sita, vt);
00199 
00200   vt = <a class="code" href="renderglobj_C.html#a8">point_y_rotation</a>(ry, vt);
00201   vt = <a class="code" href="renderglobj_C.html#a7">point_x_rotation</a>(-rx, vt);
00202 
00203   <font class="keywordflow">return</font> vt;
00204 }
00205 
00206 
<a name="l00207"></a><a class="code" href="renderglobj_C.html#a15">00207</a> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> <a class="code" href="renderglobj_C.html#a15">free_rotate</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; axis, <font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; m, <font class="keywordtype">double</font> sita)<font class="keyword">
</font>00208 <font class="keyword"></font>{
00209   <font class="keywordtype">double</font> rx, ry;
00210   <font class="keywordtype">double</font> diagnal_xy;
00211   <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> mt(4, 4), mr(4, 4);
00212 
00213   <font class="comment">// get the rotation angle rx around x to make the axis to be in zx plane</font>
00214   rx = atan2(axis[1], axis[2]);
00215 
00217   <font class="comment">// because diagnal_xy might be negative</font>
00218   diagnal_xy = sqrt(axis[1]*axis[1]+axis[2]*axis[2]);
00219 
00220   <font class="comment">// get the rotate angle ry around y to make the axis to be withe z axis</font>
00221   ry = atan2(axis[0], diagnal_xy);
00222 
00223   mt = m;
00224 
00225   <a class="code" href="renderglobj_C.html#a4">rotate_x_matrix</a>(rx, mr);
00226   mt = mr * mt;
00227 
00228   <a class="code" href="renderglobj_C.html#a5">rotate_y_matrix</a>(-ry, mr);
00229   mt = mr * mt;
00230 
00231   <a class="code" href="renderglobj_C.html#a6">rotate_z_matrix</a>(sita, mr);
00232   mt = mr * mt;
00233 
00234   <a class="code" href="renderglobj_C.html#a5">rotate_y_matrix</a>(ry, mr);
00235   mt = mr * mt;
00236 
00237   <a class="code" href="renderglobj_C.html#a4">rotate_x_matrix</a>(-rx, mr);
00238   mt = mr * mt;
00239 
00240   <font class="keywordflow">return</font> mt;
00241 }
00242 
00243 
00244 <font class="comment">//**!!!!!!!!!!!!!!!!!!!!!!!!!!! -- come from matrix.C -- 1/5/01</font>
00245 
00246 
00247 <font class="keyword">static</font>  list&lt;string&gt; MaterialFileList;
00248 <font class="keyword">static</font>  <font class="keywordtype">int</font>          numSkip    = 0;
00249 <font class="keyword">static</font>  <font class="keywordtype">int</font>          numOther   = 0;
00250 
<a name="l00251"></a><a class="code" href="renderglobj_C.html#a0">00251</a> <font class="preprocessor">#define GROW(_v, _t) \
</font>00252 <font class="preprocessor">    if (_v == NULL) \
</font>00253 <font class="preprocessor">    { \
</font>00254 <font class="preprocessor">        _v ## Available = CHUNK; \
</font>00255 <font class="preprocessor">        _v = (_t *) malloc(sizeof(_t)*_v ## Available); \
</font>00256 <font class="preprocessor">    } \
</font>00257 <font class="preprocessor">    else \
</font>00258 <font class="preprocessor">    if (_v ## Count &gt;= _v ## Available) \
</font>00259 <font class="preprocessor">    { \
</font>00260 <font class="preprocessor">        _v ## Available *= 2; \
</font>00261 <font class="preprocessor">        _v = (_t *) realloc(_v, sizeof(_t)*_v ## Available); \
</font>00262 <font class="preprocessor">    }
</font>00263 <font class="preprocessor"></font>
00264 
00265 <font class="keyword">static</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> getint(FILE *fp)<font class="keyword">
</font>00266 <font class="keyword"></font>{
00267   <font class="keywordtype">int</font> c, c1, c2, c3;
00268 
00269   <font class="comment">/* get 4 bytes*/</font>
00270   c = getc(fp);  
00271   c1 = getc(fp);  
00272   c2 = getc(fp);  
00273   c3 = getc(fp);
00274   
00275   <font class="keywordflow">return</font> ((<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>) c) +   
00276     (((<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>) c1) &lt;&lt; 8) + 
00277     (((<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>) c2) &lt;&lt; 16) +
00278     (((<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>) c3) &lt;&lt; 24);
00279 }
00280 
00281 <font class="keyword">static</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> getshort(FILE *fp)<font class="keyword">
</font>00282 <font class="keyword"></font>{
00283   <font class="keywordtype">int</font> c, c1;
00284   
00285   <font class="comment">/*get 2 bytes*/</font>
00286   c = getc(fp);  
00287   c1 = getc(fp);
00288  
00289   <font class="keywordflow">return</font> ((<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>) c) + (((<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>) c1) &lt;&lt; 8);
00290 }
00291 
00292 
<a name="l00293"></a><a class="code" href="class_Image.html#a0">00293</a> <a class="code" href="class_Image.html#a0">Image::Image</a>()<font class="keyword">
</font>00294 <font class="keyword"></font>{
00295   sizeX = (<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font>) 256;
00296   sizeY = (<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font>) 256;
00297 
00298   data = <font class="keyword">new</font> <font class="keywordtype">char</font>[10];
00299 }
00300 
<a name="l00301"></a><a class="code" href="class_Image.html#a1">00301</a> <a class="code" href="class_Image.html#a1">Image::~Image</a>()<font class="keyword">
</font>00302 <font class="keyword"></font>{
00303   <font class="comment">//  if(data != NULL)</font>
00304   <font class="comment">//    free(data);</font>
00305 }
00306 
00307 
<a name="l00308"></a><a class="code" href="class_mslGLMaterial.html#a0">00308</a> <a class="code" href="class_mslGLMaterial.html#a0">mslGLMaterial::mslGLMaterial</a>()<font class="keyword">
</font>00309 <font class="keyword"></font>{
00310   TextureImage = <font class="keyword">new</font> <a class="code" href="class_Image.html">Image</a>; 
00311   TextureHandle = 0;
00312 
00313   AmbientOn = 0;
00314   SpecularOn = 0;
00315   DiffuseOn = 0;
00316   ShininessOn = 0;
00317   AlphaOn = 0;
00318   ReflectOn = 0;
00319   TwosideOn = 0;  
00320   TextureOn = 0;
00321 
00322   ID = 0;
00323 }
00324 
00325 
<a name="l00326"></a><a class="code" href="class_mslGLMaterial.html#a1">00326</a> <a class="code" href="class_mslGLMaterial.html#a1">mslGLMaterial::~mslGLMaterial</a>()<font class="keyword">
</font>00327 <font class="keyword"></font>{
00328   <font class="comment">//  if(TextureImage != NULL)</font>
00329   <font class="comment">//    free(TextureImage);</font>
00330 }
00331 
<a name="l00332"></a><a class="code" href="class_mslGLMaterial.html#a2">00332</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLMaterial.html#a2">mslGLMaterial::SetMaterial</a>()<font class="keyword">
</font>00333 <font class="keyword"></font>{
00334   GLenum drawmode;
00335 
00336   <font class="keywordflow">if</font>(TwosideOn) 
00337     drawmode = GL_FRONT_AND_BACK;
00338   <font class="keywordflow">else</font> 
00339     drawmode = GL_FRONT;
00340 
00341   <font class="keywordflow">if</font>(TextureOn)
00342     {
00343       glEnable(GL_TEXTURE_2D);
00344       glBindTexture(GL_TEXTURE_2D, TextureHandle); 
00345     }
00346   <font class="keywordflow">else</font>
00347     glDisable(GL_TEXTURE_2D);
00348 
00349   <font class="keywordflow">if</font>(DiffuseOn)  
00350     {
00351       glMaterialfv(drawmode, GL_DIFFUSE, Diffuse);
00352       <font class="keywordflow">if</font>(AlphaOn)
00353         {
00354           glEnable(GL_BLEND);
00355           glColor4f(Color[0], Color[1], Color[2], Alpha);
00356         }
00357       <font class="keywordflow">else</font>
00358         {
00359           glDisable(GL_BLEND);
00360           glColor4f(Color[0], Color[1], Color[2], 1.0);
00361         }
00362     }
00363   
00364   <font class="keywordflow">if</font>(AmbientOn)   glMaterialfv(drawmode, GL_AMBIENT, Ambient);
00365   <font class="keywordflow">if</font>(SpecularOn)  glMaterialfv(drawmode, GL_SPECULAR, Specular);
00366   <font class="keywordflow">if</font>(ShininessOn) glMaterialf(drawmode, GL_SHININESS, Shininess);
00367 }
00368 
00369 
<a name="l00370"></a><a class="code" href="class_mslGLMaterial.html#a3">00370</a> <font class="keywordtype">int</font> <a class="code" href="class_mslGLMaterial.html#a3">mslGLMaterial::ImageLoad</a>(<font class="keywordtype">int</font> id, string path, string filename)<font class="keyword">
</font>00371 <font class="keyword"></font>{
00372     FILE *file;
00373     <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> size;
00374     <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> i;                   
00375     <font class="keywordtype">unsigned</font> <font class="keywordtype">short</font> <font class="keywordtype">int</font> planes;         
00376     <font class="keywordtype">unsigned</font> <font class="keywordtype">short</font> <font class="keywordtype">int</font> bpp;            
00377     GLuint gutmp;
00378     <font class="keywordtype">char</font> temp;                         
00379     <font class="keywordtype">void</font> * mem;
00380 
00381     <font class="keywordflow">if</font> ((file = fopen((path + filename).c_str(), <font class="stringliteral">"rb"</font>))==NULL) {
00382       cout &lt;&lt; <font class="stringliteral">"File "</font> &lt;&lt; filename &lt;&lt; <font class="stringliteral">" Not Found!\n"</font>;
00383       TextureOn = 0;
00384       <font class="keywordflow">return</font> 0;
00385     }
00386     <font class="keywordflow">else</font>
00387       TextureOn = 1;
00388     
00389     <font class="comment">/* seek through the bmp header, up to the width/height:*/</font>
00390     fseek(file, 18, SEEK_CUR);
00391 
00392    
00393     <font class="comment">//**!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</font>
00394     <font class="comment">// for SGI machine  </font>
00395     TextureImage-&gt;sizeX = getint (file);
00396     cout &lt;&lt; <font class="stringliteral">"Width of"</font> &lt;&lt; filename &lt;&lt;<font class="stringliteral">" : "</font> &lt;&lt; TextureImage-&gt;sizeX &lt;&lt; <font class="stringliteral">"\n"</font>;
00397     TextureImage-&gt;sizeY = getint (file);
00398     cout &lt;&lt; <font class="stringliteral">"Height of"</font> &lt;&lt; filename &lt;&lt;<font class="stringliteral">" : "</font> &lt;&lt; TextureImage-&gt;sizeY &lt;&lt; <font class="stringliteral">"\n"</font>;
00399     size = TextureImage-&gt;sizeX * TextureImage-&gt;sizeY * 3;
00400     planes = getshort(file);
00401     <font class="keywordflow">if</font> (planes != 1) {
00402       cout &lt;&lt; <font class="stringliteral">"Planes from "</font> &lt;&lt; filename &lt;&lt; <font class="stringliteral">" is not 1: "</font> &lt;&lt;planes &lt;&lt; <font class="stringliteral">"\n"</font>;
00403       <font class="keywordflow">return</font> 0;
00404     }
00405     bpp = getshort(file);
00406     <font class="keywordflow">if</font> (bpp != 24) {
00407       cout &lt;&lt; <font class="stringliteral">"Bpp from "</font> &lt;&lt; filename &lt;&lt; <font class="stringliteral">" is not 24: "</font> &lt;&lt; bpp &lt;&lt;<font class="stringliteral">" \n"</font>;
00408       <font class="keywordflow">return</font> 0;
00409     }
00410        
00411     <font class="comment">/*
</font>00412 <font class="comment">    //  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
</font>00413 <font class="comment">    // for linux
</font>00414 <font class="comment">    unsigned long sizex, sizey;                 
</font>00415 <font class="comment">
</font>00416 <font class="comment">    if ((i = fread(&amp;sizex, 4, 1, file)) != 1) {
</font>00417 <font class="comment">      cout &lt;&lt; "Error reading width from " &lt;&lt; filename &lt;&lt; ".\n";
</font>00418 <font class="comment">      return 0;
</font>00419 <font class="comment">    }
</font>00420 <font class="comment">    else  TextureImage-&gt;sizeX = (unsigned long) sizex;
</font>00421 <font class="comment">    //    cout &lt;&lt; "Width of " &lt;&lt; filename &lt;&lt; " is: " &lt;&lt; TextureImage-&gt;sizeX &lt;&lt; "\n";
</font>00422 <font class="comment">    if ((i = fread(&amp;sizey, 4, 1, file)) != 1) {
</font>00423 <font class="comment">      cout &lt;&lt; "Error reading height from " &lt;&lt;  filename &lt;&lt; endl;
</font>00424 <font class="comment">      return 0;
</font>00425 <font class="comment">    }
</font>00426 <font class="comment">    else  TextureImage-&gt;sizeY = (unsigned long) sizey;
</font>00427 <font class="comment">    //    cout &lt;&lt; "Height of " &lt;&lt; filename &lt;&lt;" : " &lt;&lt; TextureImage-&gt;sizeY &lt;&lt; "\n";
</font>00428 <font class="comment">
</font>00429 <font class="comment">    size = TextureImage-&gt;sizeX * TextureImage-&gt;sizeY * 3;
</font>00430 <font class="comment">    if ((fread(&amp;planes, 2, 1, file)) != 1) {
</font>00431 <font class="comment">      cout &lt;&lt; "Error reading planes from " &lt;&lt;  filename &lt;&lt; endl;
</font>00432 <font class="comment">      return 0;
</font>00433 <font class="comment">    }
</font>00434 <font class="comment">    if (planes != 1) {
</font>00435 <font class="comment">      cout &lt;&lt; "Planes from " &lt;&lt; filename &lt;&lt; " is not 1: " &lt;&lt;planes &lt;&lt; "\n";
</font>00436 <font class="comment">      return 0;
</font>00437 <font class="comment">    }
</font>00438 <font class="comment">    if ((i = fread(&amp;bpp, 2, 1, file)) != 1) {
</font>00439 <font class="comment">      cout &lt;&lt; "Error reading bpp from " &lt;&lt;  filename &lt;&lt; endl;
</font>00440 <font class="comment">      return 0;
</font>00441 <font class="comment">    }
</font>00442 <font class="comment">    if (bpp != 24) {
</font>00443 <font class="comment">      cout &lt;&lt; "Bpp from " &lt;&lt; filename &lt;&lt; " is not 24: " &lt;&lt; bpp &lt;&lt;" \n";
</font>00444 <font class="comment">      return 0;
</font>00445 <font class="comment">    }
</font>00446 <font class="comment">    //  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
</font>00447 <font class="comment">    */</font>    
00448 
00449     fseek(file, 24, SEEK_CUR);
00450 
00451     <font class="keywordflow">if</font>((mem = realloc(TextureImage-&gt;data,
00452                       <font class="keyword">sizeof</font>(<font class="keywordtype">char</font>)*(size))) == 0) {
00453         printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
00454         exit(-1);
00455     }
00456 
00457     TextureImage-&gt;data = (<font class="keywordtype">char</font> *) mem;
00458 
00459     <font class="keywordflow">if</font> ((i = fread(TextureImage-&gt;data, size, 1, file)) != 1) {
00460       cout &lt;&lt; <font class="stringliteral">"Error reading image data from "</font> &lt;&lt; filename &lt;&lt;<font class="stringliteral">" \n"</font>;
00461       <font class="keywordflow">return</font> 0;
00462     }
00463 
00464     <font class="keywordflow">for</font> (i=0;i&lt;size;i+=3) { /* reverse all of the colors. (bgr -&gt; rgb)*/
00465       temp = TextureImage-&gt;data[i];
00466       TextureImage-&gt;data[i] = TextureImage-&gt;data[i+2];
00467       TextureImage-&gt;data[i+2] = temp;
00468     }
00469 
00470     glGenTextures((GLsizei)1, &amp;gutmp);
00471     TextureHandle = (GLuint) gutmp; 
00472 
00473     glBindTexture(GL_TEXTURE_2D, TextureHandle); 
00474     glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);
00475     glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
00476     glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
00477     glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
00478     glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, TextureImage-&gt;sizeX, 
00479                  TextureImage-&gt;sizeY, 0, GL_RGB, GL_UNSIGNED_BYTE, 
00480                  TextureImage-&gt;data);
00481     
00482     <font class="keywordflow">return</font> 1;  
00483 }
00484 
00485 
<a name="l00486"></a><a class="code" href="class_mslGLMaterial.html#a4">00486</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLMaterial.html#a4">mslGLMaterial::Clear</a>()<font class="keyword">
</font>00487 <font class="keyword"></font>{
00488   TextureHandle = 0;
00489 
00490   TextureOn = 0;
00491   AmbientOn = 0;
00492   SpecularOn = 0;
00493   DiffuseOn = 0;
00494   ShininessOn = 0;
00495   AlphaOn = 0;
00496   ReflectOn = 0;
00497   TwosideOn = 0;    
00498 }
00499 
<a name="l00500"></a><a class="code" href="class_mslGLMaterial.html#a5">00500</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLMaterial.html#a5">mslGLMaterial::Print</a>()<font class="keyword">
</font>00501 <font class="keyword"></font>{
00502   cout &lt;&lt; <font class="stringliteral">"Texture Name: "</font> &lt;&lt; Name &lt;&lt; endl;
00503   cout &lt;&lt; <font class="stringliteral">"Texture Handel: "</font> &lt;&lt; TextureHandle &lt;&lt; endl;
00504   cout &lt;&lt; <font class="stringliteral">"Material ID: "</font> &lt;&lt; ID &lt;&lt; endl;
00505 
00506   <font class="keywordflow">if</font>(DiffuseOn)
00507     cout &lt;&lt; <font class="stringliteral">"Diffuse: "</font> &lt;&lt; Diffuse[0] &lt;&lt; <font class="stringliteral">"  "</font> &lt;&lt; Diffuse[1] &lt;&lt; <font class="stringliteral">" "</font> &lt;&lt; Diffuse[2] &lt;&lt; endl;
00508   <font class="keywordflow">if</font>(AmbientOn)
00509     cout &lt;&lt; <font class="stringliteral">"Ambient: "</font> &lt;&lt; Ambient[0] &lt;&lt; <font class="stringliteral">"  "</font> &lt;&lt; Ambient[1] &lt;&lt; <font class="stringliteral">" "</font> &lt;&lt; Ambient[2] &lt;&lt; endl;
00510   <font class="keywordflow">if</font>(SpecularOn)
00511     cout &lt;&lt; <font class="stringliteral">"Specular: "</font> &lt;&lt; Specular[0] &lt;&lt; <font class="stringliteral">"  "</font> &lt;&lt; Specular[1] &lt;&lt; <font class="stringliteral">" "</font> &lt;&lt; Specular[2] &lt;&lt; endl;
00512   <font class="keywordflow">if</font>(ShininessOn)
00513     cout &lt;&lt; <font class="stringliteral">"Shininess: "</font> &lt;&lt; Shininess &lt;&lt; endl;
00514 }
00515 
00516 
<a name="l00517"></a><a class="code" href="class_mslGLFace.html#a0">00517</a> <a class="code" href="class_mslGLFace.html#a0">mslGLFace::mslGLFace</a>()<font class="keyword">
</font>00518 <font class="keyword"></font>{
00519   VerticeCoord = NULL; <font class="comment">//new mslGLVertex[2];</font>
00520   NormalCoord = NULL ; <font class="comment">//new mslGLNormal[2];</font>
00521   TextureCoord = NULL; <font class="comment">//new mslGLTexCoord[2];</font>
00522 
00523   NumberOfPoint = 0;
00524   NumberOfNormal = 0;
00525   NumberOfTexCoord = 0;
00526 
00527   NormalOn = 1;         <font class="comment">// open normal  </font>
00528   TextureOn = 1;        <font class="comment">// open texure</font>
00529   ColorOn = 1;          <font class="comment">// open color</font>
00530 
00531   MaterialID = -1;
00532 }
00533 
00534 
<a name="l00535"></a><a class="code" href="class_mslGLFace.html#a1">00535</a> <a class="code" href="class_mslGLFace.html#a1">mslGLFace::~mslGLFace</a>()<font class="keyword">
</font>00536 <font class="keyword"></font>{
00537   <font class="comment">/*
</font>00538 <font class="comment">  if(VerticeCoord != NULL)
</font>00539 <font class="comment">    free(VerticeCoord);
</font>00540 <font class="comment">  
</font>00541 <font class="comment">  if(NormalCoord != NULL)
</font>00542 <font class="comment">    free(NormalCoord);
</font>00543 <font class="comment">  
</font>00544 <font class="comment">  if(TextureCoord != NULL)
</font>00545 <font class="comment">    free(TextureCoord);  
</font>00546 <font class="comment">  */</font>
00547 }
00548 
<a name="l00549"></a><a class="code" href="class_mslGLFace.html#a2">00549</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLFace.html#a2">mslGLFace::AddVertex</a>(<font class="keyword">const</font> mslGLVertex&amp; ver)<font class="keyword">
</font>00550 <font class="keyword"></font>{
00551   <font class="keywordflow">if</font>(VerticeCoord == NULL)
00552     {
00553       <font class="keywordflow">if</font>((VerticeCoord = (mslGLVertex *) malloc(<font class="keyword">sizeof</font>(mslGLVertex))) == 0)
00554         {
00555           printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
00556           exit(-1);
00557         }
00558     }
00559   <font class="keywordflow">else</font> 
00560     <font class="keywordflow">if</font>((VerticeCoord  = (mslGLVertex *) realloc(VerticeCoord,
00561                                                 <font class="keyword">sizeof</font>(mslGLVertex)*(NumberOfPoint+1))) == 0) 
00562       {
00563         printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
00564         exit(-1);
00565       }
00566 
00567   VerticeCoord[NumberOfPoint].x = ver.x;
00568   VerticeCoord[NumberOfPoint].y = ver.y;
00569   VerticeCoord[NumberOfPoint].z = ver.z;
00570 
00571   NumberOfPoint ++;
00572 }
00573 
<a name="l00574"></a><a class="code" href="class_mslGLFace.html#a3">00574</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLFace.html#a3">mslGLFace::AddNormal</a>(<font class="keyword">const</font> mslGLNormal&amp; nor)<font class="keyword">
</font>00575 <font class="keyword"></font>{
00576   <font class="keywordflow">if</font>(NormalCoord == NULL)
00577     {
00578       <font class="keywordflow">if</font>((NormalCoord = (mslGLNormal *) malloc(<font class="keyword">sizeof</font>(mslGLNormal))) == 0)
00579         {
00580           printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
00581           exit(-1);
00582         }
00583     }
00584   <font class="keywordflow">else</font> 
00585     <font class="keywordflow">if</font>((NormalCoord  = (mslGLNormal *) realloc(NormalCoord,
00586                                                <font class="keyword">sizeof</font>(mslGLNormal)*(NumberOfNormal+1))) == 0) 
00587       {
00588         printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
00589         exit(-1);
00590       }
00591 
00592   NormalCoord[NumberOfNormal].x = nor.x;
00593   NormalCoord[NumberOfNormal].y = nor.y;
00594   NormalCoord[NumberOfNormal].z = nor.z;
00595 
00596   NumberOfNormal ++;
00597 }
00598 
<a name="l00599"></a><a class="code" href="class_mslGLFace.html#a4">00599</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLFace.html#a4">mslGLFace::AddTexCoord</a>(<font class="keyword">const</font> mslGLTexCoord&amp; tex)<font class="keyword">
</font>00600 <font class="keyword"></font>{
00601   <font class="keywordflow">if</font>(TextureCoord == NULL)
00602     {
00603       <font class="keywordflow">if</font>((TextureCoord = (mslGLTexCoord *) malloc(<font class="keyword">sizeof</font>(mslGLTexCoord))) == 0)
00604         {
00605           printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
00606           exit(-1);
00607         }
00608     }
00609   <font class="keywordflow">else</font> 
00610     <font class="keywordflow">if</font>((TextureCoord  = (mslGLTexCoord *) realloc(TextureCoord,
00611                                                   <font class="keyword">sizeof</font>(mslGLTexCoord)*(NumberOfTexCoord+1))) == 0) 
00612       {
00613         printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
00614         exit(-1);
00615       }
00616 
00617   TextureCoord[NumberOfTexCoord].x = tex.x;
00618   TextureCoord[NumberOfTexCoord++].y = tex.y;
00619 }
00620 
<a name="l00621"></a><a class="code" href="class_mslGLFace.html#a5">00621</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLFace.html#a2">mslGLFace::AddVertex</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; ver)<font class="keyword">
</font>00622 <font class="keyword"></font>{
00623   <font class="keywordtype">void</font> *mem;
00624 
00625   <font class="keywordflow">if</font>((mem = realloc(VerticeCoord,
00626                     <font class="keyword">sizeof</font>(mslGLVertex)*(NumberOfPoint+1))) == 0) {
00627     printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
00628     exit(-1);
00629   }
00630 
00631   VerticeCoord=(mslGLVertex *) mem;
00632 
00633   VerticeCoord[NumberOfPoint].x = ver[0];
00634   VerticeCoord[NumberOfPoint].y = ver[1];
00635   VerticeCoord[NumberOfPoint].z = ver[2];
00636   
00637   NumberOfPoint++;
00638 }
00639 
<a name="l00640"></a><a class="code" href="class_mslGLFace.html#a6">00640</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLFace.html#a3">mslGLFace::AddNormal</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; nor)<font class="keyword">
</font>00641 <font class="keyword"></font>{
00642   <font class="keywordtype">void</font> *mem;
00643   
00644   <font class="keywordflow">if</font>((mem = realloc(NormalCoord,
00645                     <font class="keyword">sizeof</font>(mslGLNormal)*(NumberOfNormal+1))) == 0) {
00646     printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
00647     exit(-1);
00648   }
00649 
00650   NormalCoord=(mslGLNormal *) mem;
00651 
00652   NormalCoord[NumberOfNormal].x = nor[0];
00653   NormalCoord[NumberOfNormal].y = nor[1];
00654   NormalCoord[NumberOfNormal].z = nor[2];
00655 
00656   NumberOfNormal ++;
00657 }
00658 
<a name="l00659"></a><a class="code" href="class_mslGLFace.html#a7">00659</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLFace.html#a4">mslGLFace::AddTexCoord</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; tex)<font class="keyword">
</font>00660 <font class="keyword"></font>{
00661   <font class="keywordtype">void</font> *mem;
00662   
00663   <font class="keywordflow">if</font>((mem = realloc(TextureCoord,
00664                     <font class="keyword">sizeof</font>(mslGLTexCoord)*(NumberOfTexCoord+1))) == 0) {
00665     printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
00666     exit(-1);
00667   }
00668 
00669   TextureCoord=(mslGLTexCoord *) mem;
00670 
00671   TextureCoord[NumberOfTexCoord].x = tex[0];
00672   TextureCoord[NumberOfTexCoord].y = tex[1];
00673 
00674   NumberOfTexCoord++;
00675 }
00676 
00677 
<a name="l00678"></a><a class="code" href="class_mslGLFace.html#a8">00678</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLFace.html#a8">mslGLFace::Clear</a>()<font class="keyword">
</font>00679 <font class="keyword"></font>{
00680   NumberOfPoint = 0;
00681   NumberOfNormal = 0;
00682   NumberOfTexCoord = 0;
00683 
00684   <font class="comment">/*
</font>00685 <font class="comment">  if(VerticeCoord != NULL)
</font>00686 <font class="comment">    free(VerticeCoord);
</font>00687 <font class="comment">  if(NormalCoord != NULL)
</font>00688 <font class="comment">    free(NormalCoord);
</font>00689 <font class="comment">  if(TextureCoord != NULL)
</font>00690 <font class="comment">    free(TextureCoord);
</font>00691 <font class="comment">  */</font>
00692 
00693   VerticeCoord = NULL; <font class="comment">//new mslGLVertex;</font>
00694   NormalCoord = NULL; <font class="comment">//new mslGLNormal;</font>
00695   TextureCoord = NULL; <font class="comment">//new mslGLTexCoord;</font>
00696 
00697   NormalOn = 1;         <font class="comment">// open normal  </font>
00698   TextureOn = 1;        <font class="comment">// open texure</font>
00699   ColorOn = 1;          <font class="comment">// open color</font>
00700 
00701   MaterialID = -1;  
00702 }
00703 
<a name="l00704"></a><a class="code" href="class_mslGLFace.html#a9">00704</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLFace.html#a9">mslGLFace::PrintVertex</a>()<font class="keyword">
</font>00705 <font class="keyword"></font>{
00706   <font class="keywordtype">int</font> i;
00707   mslGLVertex v;
00708 
00709   <font class="keywordflow">for</font>(i=0; i&lt;NumberOfPoint; i++)
00710     {
00711       v = VerticeCoord[i];
00712       cout &lt;&lt; <font class="stringliteral">"("</font> &lt;&lt; v.x &lt;&lt; <font class="stringliteral">" "</font> &lt;&lt; v.y &lt;&lt; <font class="stringliteral">" "</font>&lt;&lt; v.z &lt;&lt; <font class="stringliteral">") "</font>;
00713     }
00714   
00715   cout &lt;&lt; endl;
00716 }
00717 
00718 
<a name="l00719"></a><a class="code" href="class_mslGLFace.html#a10">00719</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLFace.html#a10">mslGLFace::DrawFace</a>()<font class="keyword">
</font>00720 <font class="keyword"></font>{
00721   <font class="keywordtype">int</font> i;
00722 
00723   mslGLVertex v1, v2, v3;
00724   mslGLNormal n1, n2, n3, n;
00725   mslGLTexCoord t1, t2, t3;
00726 
00727   v1 = VerticeCoord[0];
00728   v2 = VerticeCoord[1];
00729   
00730   <font class="keywordflow">if</font>(NormalOn)
00731     {
00732       n1 = NormalCoord[0];
00733       n2 = NormalCoord[1];
00734     }
00735 
00736   <font class="keywordflow">if</font>(TextureOn)
00737     {
00738       t1 = TextureCoord[0];
00739       t2 = TextureCoord[1];
00740     }
00741 
00742   glBegin(GL_TRIANGLES);
00743 
00744   <font class="keywordflow">for</font>(i=0; i&lt;NumberOfPoint-2; i++)
00745     {
00746       v3 = VerticeCoord[i+2];
00747       <font class="keywordflow">if</font>(NormalOn)  n3 = NormalCoord[i+2];
00748       <font class="keywordflow">if</font>(TextureOn) t3 = TextureCoord[i+2];
00749 
00750       <font class="keywordflow">if</font>((<font class="keywordtype">float</font>)i/2.0==0)
00751         {
00752           <font class="keywordflow">if</font>(NormalOn)
00753             {
00754               glNormal3f(n1.x, n1.y, n1.z);
00755               <font class="keywordflow">if</font>(TextureOn) glTexCoord2f(t1.x, t1.y); 
00756               glVertex3f(v1.x, v1.y, v1.z);
00757 
00758               glNormal3f(n2.x, n2.y, n2.z);
00759               <font class="keywordflow">if</font>(TextureOn) glTexCoord2f(t2.x, t2.y); 
00760               glVertex3f(v2.x, v2.y, v2.z);
00761 
00762               glNormal3f(n3.x, n3.y, n3.z);
00763               <font class="keywordflow">if</font>(TextureOn) glTexCoord2f(t3.x, t3.y); 
00764               glVertex3f(v3.x, v3.y, v3.z);
00765             }
00766           <font class="keywordflow">else</font>
00767             {
00768               n = <a class="code" href="renderglobj_C.html#a18">NormalCompute</a>(v1, v2, v3);
00769               glNormal3f(n.x, n.y, n.z);
00770 
00771               <font class="keywordflow">if</font>(TextureOn) glTexCoord2f(t1.x, t1.y); 
00772               glVertex3f(v1.x, v1.y, v1.z);
00773               <font class="keywordflow">if</font>(TextureOn) glTexCoord2f(t2.x, t2.y); 
00774               glVertex3f(v2.x, v2.y, v2.z);
00775               <font class="keywordflow">if</font>(TextureOn) glTexCoord2f(t3.x, t3.y); 
00776               glVertex3f(v3.x, v3.y, v3.z);
00777             }
00778         }
00779       <font class="keywordflow">else</font>
00780         {
00781           <font class="keywordflow">if</font>(NormalOn)
00782             {
00783               glNormal3f(n2.x, n2.y, n2.z);
00784               <font class="keywordflow">if</font>(TextureOn) glTexCoord2f(t2.x, t2.y); 
00785               glVertex3f(v2.x, v2.y, v2.z);
00786               
00787               glNormal3f(n1.x, n1.y, n1.z);
00788               <font class="keywordflow">if</font>(TextureOn) glTexCoord2f(t1.x, t1.y); 
00789               glVertex3f(v1.x, v1.y, v1.z);
00790 
00791               glNormal3f(n3.x, n3.y, n3.z);
00792               <font class="keywordflow">if</font>(TextureOn) glTexCoord2f(t3.x, t3.y); 
00793               glVertex3f(v3.x, v3.y, v3.z);       
00794             }
00795           <font class="keywordflow">else</font>
00796             {
00797               n = <a class="code" href="renderglobj_C.html#a18">NormalCompute</a>(v2, v1, v3);
00798               glNormal3f(n.x, n.y, n.z);
00799 
00800               <font class="keywordflow">if</font>(TextureOn) glTexCoord2f(t2.x, t2.y); 
00801               glVertex3f(v2.x, v2.y, v2.z);
00802               <font class="keywordflow">if</font>(TextureOn) glTexCoord2f(t1.x, t1.y); 
00803               glVertex3f(v1.x, v1.y, v1.z);
00804               <font class="keywordflow">if</font>(TextureOn) glTexCoord2f(t3.x, t3.y); 
00805               glVertex3f(v3.x, v3.y, v3.z);
00806             }
00807         }
00808 
00809       v1 = v2; v2 = v3;
00810       n1 = n2; n2 = n3;
00811       t1 = t2; t2 = t3;
00812     }
00813 
00814   glEnd();
00815 }
00816 
00817 
<a name="l00818"></a><a class="code" href="class_mslGLObject.html#a0">00818</a> <a class="code" href="class_mslGLObject.html#a0">mslGLObject::mslGLObject</a>()<font class="keyword">
</font>00819 <font class="keyword"></font>{
00820   <font class="comment">//  Name = new char[MAXNAME_LENGTH];</font>
00821 
00822   ObjectMaterialLib = NULL;
00823   ObjectFaceLib = NULL;
00824 
00825   NumberOfMaterial = 0;
00826   NumberOfFace = 0;
00827 
00828   BoundingBoxMin[0] = 0.0;
00829   BoundingBoxMin[1] = 0.0;
00830   BoundingBoxMin[2] = 0.0;
00831 
00832   BoundingBoxMax[0] = 0.0;
00833   BoundingBoxMax[1] = 0.0;
00834   BoundingBoxMax[2] = 0.0;
00835 }
00836 
00837 
<a name="l00838"></a><a class="code" href="class_mslGLObject.html#a1">00838</a> <a class="code" href="class_mslGLObject.html#a1">mslGLObject::~mslGLObject</a>()<font class="keyword">
</font>00839 <font class="keyword"></font>{
00840 }
00841 
00842 
<a name="l00843"></a><a class="code" href="class_mslGLObject.html#a11">00843</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a11">mslGLObject::Clear</a>()<font class="keyword">
</font>00844 <font class="keyword"></font>{
00845   
00846   ObjectMaterialLib = NULL;
00847   ObjectFaceLib = NULL;
00848 
00849   NumberOfMaterial = 0;
00850   NumberOfFace = 0;
00851 
00852   BoundingBoxMin[0] = 0.0;
00853   BoundingBoxMin[1] = 0.0;
00854   BoundingBoxMin[2] = 0.0;
00855 
00856   BoundingBoxMax[0] = 0.0;
00857   BoundingBoxMax[1] = 0.0;
00858   BoundingBoxMax[2] = 0.0;
00859 }
00860 
<a name="l00861"></a><a class="code" href="class_mslGLObject.html#a2">00861</a> <font class="keywordtype">int</font> <a class="code" href="class_mslGLObject.html#a2">mslGLObject::ReadModelFile</a>(<font class="keyword">const</font> string&amp; path, <font class="keyword">const</font> string&amp; fileName)<font class="keyword">
</font>00862 <font class="keyword"></font>{
00863     FILE         *objFile;
00864 
00865     <font class="keywordtype">int</font>          currentMaterialID = -1;
00866 
00867     <font class="keywordtype">char</font>         buffer[BUFFER_SIZE];
00868     <font class="keywordtype">char</font>         token[BUFFER_SIZE];
00869     <font class="keywordtype">char</font>        *next           = NULL;
00870     <font class="keywordtype">char</font>        *backslash      = NULL;
00871 
00872     <font class="keywordtype">int</font>          width          = 0;
00873 
00874     <font class="keywordtype">int</font>          numTris        = 0;
00875     <font class="keywordtype">int</font>          numPolys       = 0;
00876     <font class="keywordtype">int</font>          numGroups      = 0;
00877 
00878     mslGLVertex*         v       = NULL;
00879     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>         vCount         = 0;
00880     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>         vAvailable     = 0;
00881 
00882     mslGLNormal*         n        = NULL;
00883     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>         nCount         = 0;
00884     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>         nAvailable     = 0;
00885 
00886     mslGLTexCoord*       t       = NULL;
00887     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>         tCount         = 0;
00888     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>         tAvailable     = 0;
00889 
00890     <font class="comment">/* tmp count vars */</font>
00891     <font class="keywordtype">int</font>          i, j;
00892     <font class="keywordtype">float</font>       f1, f2, f3;
00893     <a class="code" href="class_MSLVector.html">MSLVector</a>       tv1(3), tv2(2), tv3(9);
00894 
00895     Position[0] = 0.0;
00896     Position[1] = 0.0;
00897     Position[2] = 0.0;
00898 
00899     Orientation[0] = 0.0;
00900     Orientation[1] = 0.0;
00901     Orientation[2] = 0.0;
00902 
00903     Scale[0] = 1.0;
00904     Scale[1] = 1.0;
00905     Scale[2] = 1.0;
00906 
00907     <font class="keywordflow">if</font> ((objFile = fopen((path + fileName).c_str(), <font class="stringliteral">"r"</font>)) == NULL)
00908       {
00909         cout &lt;&lt; <font class="stringliteral">"can not open model file!"</font> &lt;&lt; endl;
00910         <font class="keywordflow">return</font> 1;
00911       } 
00912 
00913     Name = fileName;
00914 
00915     <font class="keywordflow">while</font> (fgets(buffer, BUFFER_SIZE, objFile) != NULL)
00916     {
00917 
00918         <font class="keywordflow">while</font> ((backslash = strchr(buffer, <font class="charliteral">'\\'</font>)) != NULL)
00919         {
00920 
00921             *backslash++ = <font class="charliteral">' '</font>;
00922             *backslash   = <font class="charliteral">'\0'</font>;
00923 
00924 
00925             <font class="keywordflow">if</font> (fgets(backslash, (<font class="keywordtype">int</font>)(BUFFER_SIZE - strlen(buffer)), objFile)
00926                 == NULL)
00927                 <font class="keywordflow">break</font>;
00928         }
00929 
00930         <font class="comment">/* find first non-"space" character in line */</font>
00931         <font class="keywordflow">for</font> (next = buffer; *next != <font class="charliteral">'\0'</font> &amp;&amp; isspace(*next); next++)
00932             <font class="comment">/* EMPTY */</font> {};
00933 
00934         <font class="comment">/* skip blank lines and comments ('$' is comment in "cow.obj") */</font>
00935         <font class="keywordflow">if</font> (*next == <font class="charliteral">'\0'</font> || *next == <font class="charliteral">'#'</font> || *next == <font class="charliteral">'!'</font> || *next == <font class="charliteral">'$'</font>)
00936             <font class="keywordflow">continue</font>;
00937 
00938         <font class="comment">/* extract token */</font>
00939         sscanf(next, <font class="stringliteral">"%s%n"</font>, token, &amp;width);
00940         next += width;
00941 
00942         <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"v"</font>))
00943         {
00944             sscanf(next, <font class="stringliteral">"%f %f %f"</font>, &amp;f1, &amp;f2, &amp;f3);        
00945 
00946             <a class="code" href="renderglobj_C.html#a0">GROW</a>(v, mslGLVertex);
00947             <font class="keywordflow">if</font>(v == 0)
00948               {
00949                 cout &lt;&lt; <font class="stringliteral">"memeory allocation error!"</font> &lt;&lt; endl;
00950                 exit(-1);
00951               }
00952 
00953             v[vCount].x = f1;
00954             v[vCount].y = f2;
00955             v[vCount].z = f3;
00956 
00957             ++vCount;
00958         }
00959         <font class="keywordflow">else</font>
00960         <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"vn"</font>))
00961         {
00962             sscanf(next, <font class="stringliteral">"%f %f %f"</font>, &amp;f1, &amp;f2, &amp;f3);
00963 
00964             <a class="code" href="renderglobj_C.html#a0">GROW</a>(n, mslGLNormal);
00965             <font class="keywordflow">if</font>(n == 0)
00966               {
00967                 cout &lt;&lt; <font class="stringliteral">"memeory allocation error!"</font> &lt;&lt; endl;
00968                 exit(-1);
00969               }
00970 
00971             n[nCount].x = f1;
00972             n[nCount].y = f2;
00973             n[nCount].z = f3;
00974 
00975             ++nCount;
00976         }
00977         <font class="keywordflow">else</font>
00978         <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"vt"</font>))
00979         {
00980             sscanf(next, <font class="stringliteral">"%f %f"</font>, &amp;f1, &amp;f2);
00981 
00982             <a class="code" href="renderglobj_C.html#a0">GROW</a>(t, mslGLTexCoord);
00983             <font class="keywordflow">if</font>(t == 0)
00984               {
00985                 cout &lt;&lt; <font class="stringliteral">"memeory allocation error!"</font> &lt;&lt; endl;
00986                 exit(-1);
00987               }
00988             
00989             t[tCount].x = f1;
00990             t[tCount].y = f2;
00991 
00992             ++tCount;
00993         }
00994         <font class="keywordflow">else</font>
00995         <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"g"</font>))
00996         {
00997             ++numGroups;
00998         }
00999         <font class="keywordflow">else</font>
01000         <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"f"</font>) ||
01001             <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"fo"</font>))
01002         {
01003             <font class="keywordtype">int</font>          count;
01004             <font class="keywordtype">int</font>          textureValid = 1;
01005             <font class="keywordtype">int</font>          normalsValid = 1;
01006             <font class="keywordtype">int</font>          vi[FACE_SIZE];
01007             <font class="keywordtype">int</font>          ti[FACE_SIZE];
01008             <font class="keywordtype">int</font>          ni[FACE_SIZE];
01009 
01010             <font class="keywordtype">char</font>        *slash;
01011             <font class="keywordtype">char</font>         vertexData[256];
01012 
01013             <a class="code" href="class_mslGLFace.html">mslGLFace</a>       tFace;
01014 
01015             <font class="keywordflow">for</font> (count = 0; count &lt; FACE_SIZE; count++)
01016             {
01017                 <font class="keywordflow">if</font> (sscanf(next, <font class="stringliteral">"%s%n"</font>, vertexData, &amp;width) != 1)
01018                     <font class="keywordflow">break</font>;
01019                 next += width;
01020                 vi[count] = (<font class="keywordtype">int</font>)strtol(vertexData, NULL, 10);
01021                 ti[count] = 0;
01022                 <font class="keywordflow">if</font> ((slash = strchr(vertexData, <font class="charliteral">'/'</font>)) == NULL ||
01023                     (ti[count] = (<font class="keywordtype">int</font>)strtol(slash+1, NULL, 10)) == 0)
01024                     textureValid = 0;
01025                 ni[count] = 0;
01026                 <font class="keywordflow">if</font> (slash == NULL || (slash = strchr(slash+1, <font class="charliteral">'/'</font>)) == NULL ||
01027                     (ni[count] = (<font class="keywordtype">int</font>)strtol(slash+1, NULL, 10)) == 0)
01028                     normalsValid = 0;
01029 
01030                 <font class="comment">/*
</font>01031 <font class="comment">                 * form cannonical indices:
</font>01032 <font class="comment">                 *   convert ".obj" 1-based indices to 0-based (subtract 1)
</font>01033 <font class="comment">                 *   convert negative indices to positive (count from 0)
</font>01034 <font class="comment">                 */</font>
01035                 <font class="keywordflow">if</font> (vi[count] &gt;= 0)
01036                     vi[count] -= 1;
01037                 <font class="keywordflow">else</font>
01038                     vi[count]  = vCount - vi[count];
01039 
01040                 <font class="keywordflow">if</font> (ti[count] &gt;= 0)
01041                     ti[count] -= 1;
01042                 <font class="keywordflow">else</font>
01043                     ti[count]  = tCount - ti[count];
01044 
01045                 <font class="keywordflow">if</font> (ni[count] &gt;= 0)
01046                     ni[count] -= 1;
01047                 <font class="keywordflow">else</font>
01048                     ni[count]  = nCount - ni[count];
01049             }
01050 
01051             <font class="keywordflow">for</font> (i = 0; i &lt; count; i++)
01052               {
01053                 tFace.<a class="code" href="class_mslGLFace.html#a2">AddVertex</a>(v[vi[i]]);
01054               }
01055 
01056             tFace.ColorOn = 0;
01057             tFace.MaterialID = currentMaterialID;
01058 
01059             <font class="comment">/* setup normal MSLVector information */</font>
01060             <font class="keywordflow">if</font> (normalsValid)
01061               {
01062                 tFace.NormalOn = 1;
01063                 <font class="keywordflow">for</font> (i = 0; i &lt; count; i++)
01064                   tFace.<a class="code" href="class_mslGLFace.html#a3">AddNormal</a>(n[ni[i]]);
01065               }
01066             <font class="keywordflow">else</font>
01067               tFace.NormalOn = 0;
01068             
01069             <font class="keywordflow">if</font> (textureValid)
01070               {
01071                 tFace.TextureOn = 1;
01072                 <font class="keywordflow">for</font> (i = 0; i &lt; count; i++)
01073                   tFace.<a class="code" href="class_mslGLFace.html#a4">AddTexCoord</a>(t[ti[i]]);
01074               }
01075             <font class="keywordflow">else</font>
01076               tFace.TextureOn = 0;
01077 
01078             <font class="keywordflow">if</font> (count &gt; 2)
01079               {
01080                 tFace.NumberOfPoint = count;
01081                 AddFace(tFace);
01082                 numTris += count - 2;
01083                 numPolys++;
01084                 
01085               }
01086         }
01087         <font class="keywordflow">else</font>
01088         <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"usemtl"</font>))
01089         {
01090             <font class="keywordtype">char</font>        mtlName[MAXNAME_LENGTH];
01091             sscanf(next, <font class="stringliteral">"%s"</font>, mtlName);
01092             currentMaterialID = SetCurrentMaterialID(mtlName);
01093         }
01094         <font class="keywordflow">else</font>
01095           <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"mtllib"</font>))
01096             {
01097               <font class="keywordtype">char</font>      libName[MAXNAME_LENGTH];
01098               sscanf(next, <font class="stringliteral">"%s"</font>, libName);
01099               LoadMaterialFile(path, libName);
01100             }
01101           <font class="keywordflow">else</font>
01102             <font class="keywordflow">if</font> (
01103                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"bevel"</font>)    ||
01104                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"bmat"</font>)             ||
01105                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"bsp"</font>)              ||
01106                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"bzp"</font>)              ||
01107                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"c_interp"</font>) ||
01108                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"cdc"</font>)              ||
01109                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"con"</font>)              ||
01110                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"cstype"</font>)   ||
01111                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"ctech"</font>)    ||
01112                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"curv"</font>)             ||
01113                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"curv2"</font>)    ||
01114                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"d_interp"</font>) ||
01115                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"deg"</font>)              ||
01116                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"end"</font>)              ||
01117                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"hole"</font>)             ||
01118                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"l"</font>)                ||
01119                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"lod"</font>)              ||
01120                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"maplib"</font>)   ||
01121                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"mg"</font>)               ||
01122                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"o"</font>)                ||
01123                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"p"</font>)                ||
01124                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"param"</font>)    ||
01125                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"parm"</font>)             ||
01126                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"res"</font>)              ||
01127                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"s"</font>)                ||
01128                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"scrv"</font>)             ||
01129                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"shadow_obj"</font>)       ||
01130                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"sp"</font>)               ||
01131                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"stech"</font>)    ||
01132                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"step"</font>)             ||
01133                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"surf"</font>)             ||
01134                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"trace_obj"</font>)        ||
01135                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"trim"</font>)             ||
01136                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"usemap"</font>)   ||
01137                 <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"vp"</font>))
01138               {
01139                 ++numSkip;
01140               }
01141 <font class="preprocessor">#ifndef STRICT_OBJ_FORMAT
</font>01142 <font class="preprocessor"></font>        <font class="comment">/*
</font>01143 <font class="comment">         * reset vertex data array counters -- this is not
</font>01144 <font class="comment">         * part of the OBJ format, but proves quite handy.
</font>01145 <font class="comment">         */</font>
01146             <font class="keywordflow">else</font>
01147               <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"RESET"</font>))
01148                 {
01149                   vCount = 0;
01150                   nCount = 0;
01151                   tCount = 0;
01152                 }
01153 <font class="preprocessor">#endif
</font>01154 <font class="preprocessor"></font>              <font class="keywordflow">else</font>
01155                 {
01156                   cout &lt;&lt; <font class="stringliteral">"unrecognize format"</font> &lt;&lt; endl;
01157                   ++numOther;
01158                 }
01159     }
01160     
01161     <font class="comment">/* close Wavefront ".obj" file */</font>
01162     fclose(objFile);
01163 
01164     <font class="keywordflow">if</font> (v != NULL) free(v);
01165     <font class="keywordflow">if</font> (n != NULL) free(n);
01166     <font class="keywordflow">if</font> (t != NULL) free(t);    
01167     
01168     <font class="keywordflow">for</font>(i=0; i&lt;NumberOfFace; i++)
01169       {
01170         <font class="keywordflow">for</font>(j=0; j&lt;ObjectFaceLib[i].NumberOfPoint; j++)
01171           {
01172             <font class="keywordflow">if</font>(ObjectFaceLib[i].VerticeCoord[j].x&gt;BoundingBoxMax[0]) 
01173               BoundingBoxMax[0] = ObjectFaceLib[i].VerticeCoord[j].x;
01174             <font class="keywordflow">if</font>(ObjectFaceLib[i].VerticeCoord[j].y&gt;BoundingBoxMax[1]) 
01175               BoundingBoxMax[1] = ObjectFaceLib[i].VerticeCoord[j].y;
01176             <font class="keywordflow">if</font>(ObjectFaceLib[i].VerticeCoord[j].z&gt;BoundingBoxMax[2]) 
01177               BoundingBoxMax[2] = ObjectFaceLib[i].VerticeCoord[j].z;
01178             
01179             <font class="keywordflow">if</font>(ObjectFaceLib[i].VerticeCoord[j].x&lt;BoundingBoxMin[0]) 
01180               BoundingBoxMin[0] = ObjectFaceLib[i].VerticeCoord[j].x;
01181             <font class="keywordflow">if</font>(ObjectFaceLib[i].VerticeCoord[j].y&lt;BoundingBoxMin[1]) 
01182               BoundingBoxMin[1] = ObjectFaceLib[i].VerticeCoord[j].y;
01183             <font class="keywordflow">if</font>(ObjectFaceLib[i].VerticeCoord[j].z&lt;BoundingBoxMin[2]) 
01184               BoundingBoxMin[2] = ObjectFaceLib[i].VerticeCoord[j].z;
01185           }
01186       }
01187 
01188     <font class="keywordflow">return</font> 0;
01189 }
01190 
01191 
<a name="l01192"></a><a class="code" href="class_mslGLObject.html#a3">01192</a> <a class="code" href="class_MSLPoint3d.html">MSLPoint3d</a> <a class="code" href="class_mslGLObject.html#a3">mslGLObject::PointCurrentState</a>(<font class="keyword">const</font> <a class="code" href="class_MSLPoint3d.html">MSLPoint3d</a>&amp; po, <font class="keywordtype">int</font> mode)<font class="keyword">
</font>01193 <font class="keyword"></font>{
01194   <a class="code" href="class_MSLVector.html">MSLVector</a> vp1(3);
01195 
01196   vp1[0] = po.<a class="code" href="class_MSLPoint3d.html#a3">xcoord</a>() * Scale[0];
01197   vp1[1] = po.<a class="code" href="class_MSLPoint3d.html#a4">ycoord</a>() * Scale[1];
01198   vp1[2] = po.<a class="code" href="class_MSLPoint3d.html#a5">zcoord</a>() * Scale[2];
01199   
01200   vp1 = <a class="code" href="renderglobj_C.html#a7">point_x_rotation</a>(Orientation[0]*PI/180.0, vp1);
01201   vp1 = <a class="code" href="renderglobj_C.html#a8">point_y_rotation</a>(Orientation[1]*PI/180.0, vp1);
01202   vp1 = <a class="code" href="renderglobj_C.html#a9">point_z_rotation</a>(Orientation[2]*PI/180.0, vp1);
01203 
01204   <font class="keywordflow">if</font>(mode == OBSTACLE_MODE)
01205     {
01206       vp1[0] = vp1[0] + Position[0];
01207       vp1[1] = vp1[1] + Position[1];
01208       vp1[2] = vp1[2] + Position[2];
01209     }
01210 
01211   <font class="keywordflow">return</font> MSLPoint3d(vp1[0],vp1[1],vp1[2]);
01212 }
01213 
01214 
01215 
<a name="l01216"></a><a class="code" href="class_mslGLObject.html#a4">01216</a> list&lt;MSLTriangle&gt; <a class="code" href="class_mslGLObject.html#a4">mslGLObject::SetBoundingBoxTriangle</a>(<font class="keywordtype">int</font> mode)<font class="keyword">
</font>01217 <font class="keyword"></font>{
01218   list&lt;MSLTriangle&gt; BoundingBoxTriangle;
01219 
01220   BoundingBoxTriangle.clear();
01221   <a class="code" href="class_MSLPoint3d.html">MSLPoint3d</a> p1, p2, p3;
01222 
01223   p1 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01224   p2 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01225   p3 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01226   p1 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p1, mode);
01227   p2 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p2, mode);
01228   p3 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p3, mode);
01229   BoundingBoxTriangle.push_front(MSLTriangle(p1, p2, p3));
01230 
01231   p1 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01232   p2 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01233   p3 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01234   p1 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p1, mode);
01235   p2 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p2, mode);
01236   p3 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p3, mode);
01237   BoundingBoxTriangle.push_front(MSLTriangle(p1, p2, p3));
01238 
01239   p1 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01240   p2 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01241   p3 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01242   p1 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p1, mode);
01243   p2 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p2, mode);
01244   p3 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p3, mode);
01245   BoundingBoxTriangle.push_front(MSLTriangle(p1, p2, p3));
01246 
01247   p1 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01248   p2 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01249   p3 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01250   p1 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p1, mode);
01251   p2 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p2, mode);
01252   p3 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p3, mode);
01253   BoundingBoxTriangle.push_front(MSLTriangle(p1, p2, p3));
01254 
01255   p1 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01256   p2 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01257   p3 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01258   p1 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p1, mode);
01259   p2 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p2, mode);
01260   p3 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p3, mode);
01261   BoundingBoxTriangle.push_front(MSLTriangle(p1, p2, p3));
01262 
01263   p1 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01264   p2 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01265   p3 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01266   p1 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p1, mode);
01267   p2 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p2, mode);
01268   p3 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p3, mode);
01269   BoundingBoxTriangle.push_front(MSLTriangle(p1, p2, p3));
01270 
01271   p1 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01272   p2 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01273   p3 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01274   p1 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p1, mode);
01275   p2 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p2, mode);
01276   p3 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p3, mode);
01277   BoundingBoxTriangle.push_front(MSLTriangle(p1, p2, p3));
01278 
01279   p1 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01280   p2 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01281   p3 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01282   p1 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p1, mode);
01283   p2 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p2, mode);
01284   p3 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p3, mode);
01285   BoundingBoxTriangle.push_front(MSLTriangle(p1, p2, p3));
01286 
01287   p1 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01288   p2 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01289   p3 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01290   p1 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p1, mode);
01291   p2 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p2, mode);
01292   p3 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p3, mode);
01293   BoundingBoxTriangle.push_front(MSLTriangle(p1, p2, p3));
01294 
01295   p1 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01296   p2 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01297   p3 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01298   p1 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p1, mode);
01299   p2 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p2, mode);
01300   p3 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p3, mode);
01301   BoundingBoxTriangle.push_front(MSLTriangle(p1, p2, p3));
01302 
01303   p1 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01304   p2 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01305   p3 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01306   p1 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p1, mode);
01307   p2 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p2, mode);
01308   p3 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p3, mode);
01309   BoundingBoxTriangle.push_front(MSLTriangle(p1, p2, p3));
01310 
01311   p1 = MSLPoint3d(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01312   p2 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01313   p3 = MSLPoint3d(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01314   p1 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p1, mode);
01315   p2 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p2, mode);
01316   p3 = <a class="code" href="class_mslGLObject.html#a3">PointCurrentState</a>(p3, mode);
01317   BoundingBoxTriangle.push_front(MSLTriangle(p1, p2, p3));
01318 
01319   <font class="keywordflow">return</font> BoundingBoxTriangle;
01320 }
01321 
01322 
01323 
<a name="l01324"></a><a class="code" href="class_mslGLObject.html#a5">01324</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a5">mslGLObject::LoadMaterialFile</a>(<font class="keyword">const</font> string&amp; path, <font class="keyword">const</font> string&amp; filename)<font class="keyword">
</font>01325 <font class="keyword"></font>{
01326     FILE        *mtlFile;
01327     <font class="keywordtype">char</font>         buffer[BUFFER_SIZE];
01328     <font class="keywordtype">char</font>         token[BUFFER_SIZE];
01329     <font class="keywordtype">char</font>        *next;
01330     <font class="keywordtype">char</font>        *backslash;
01331     <font class="keywordtype">int</font>          width  = 0;
01332     <font class="comment">//    int            i;</font>
01333     <font class="keywordtype">int</font>          inProgress = 0;
01334 
01335     <a class="code" href="class_mslGLMaterial.html">mslGLMaterial</a>   tmat;
01336     list&lt;string&gt;::iterator  tstr;
01337 
01338     <font class="comment">/* have we already loaded this file ? */</font>
01339     <a class="code" href="defs_h.html#a8">forall</a>(tstr, MaterialFileList)
01340       <font class="keywordflow">if</font> (strcmp(filename.c_str(), (*tstr).c_str()) == 0)
01341         {
01342             <font class="keywordflow">return</font>;
01343         }
01344 
01345     <font class="comment">/* remember file name for future reference */</font>
01346     <font class="keywordflow">if</font> (MaterialFileList.size() &lt; MAX_MTL_FILES)
01347       {
01348         MaterialFileList.push_back(filename);
01349       }
01350     <font class="keywordflow">else</font>
01351       {
01352         cout &lt;&lt; <font class="stringliteral">"You have exceed the limit of the number of the material file"</font> &lt;&lt; endl;
01353       }
01354 
01355     <font class="comment">/* open file */</font>
01356     <font class="keywordflow">if</font> ((mtlFile = fopen((path + filename).c_str(), <font class="stringliteral">"r"</font>)) == NULL)
01357       {
01358         cout &lt;&lt; <font class="stringliteral">"Can not open the material file"</font> &lt;&lt; endl;
01359         <font class="keywordflow">return</font>;
01360       }
01361 
01362     <font class="comment">/* read Wavefront ".mtl" file */</font>
01363     <font class="keywordflow">while</font> (fgets(buffer, BUFFER_SIZE, mtlFile) != NULL)
01364     {
01365         <font class="keywordflow">while</font> ((backslash = strchr(buffer, <font class="charliteral">'\\'</font>)) != NULL)
01366             <font class="keywordflow">if</font> (fgets(backslash, BUFFER_SIZE - strlen(buffer), mtlFile) == NULL)
01367                 <font class="keywordflow">break</font>;
01368 
01369         <font class="keywordflow">for</font> (next = buffer; *next != <font class="charliteral">'\0'</font> &amp;&amp; isspace(*next); next++)
01370             <font class="comment">/* EMPTY */</font> {};
01371         <font class="keywordflow">if</font> (*next == <font class="charliteral">'\0'</font> || *next == <font class="charliteral">'#'</font> || *next == <font class="charliteral">'!'</font> || *next == <font class="charliteral">'$'</font>)
01372             <font class="keywordflow">continue</font>;
01373         sscanf(next, <font class="stringliteral">"%s%n"</font>, token, &amp;width);
01374         next += width;
01375 
01376         <font class="comment">/* identify token */</font>
01377         <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"newmtl"</font>))
01378           {
01379             <font class="keywordflow">if</font>(inProgress)
01380               {
01381                 AddMaterial(path, tmat);
01382                 <font class="comment">//cout &lt;&lt; "TextureName: " &lt;&lt; ObjectMaterialLib[NumberOfMaterial-1].Name &lt;&lt; endl;</font>
01383               }
01384             
01385             tmat.<a class="code" href="class_mslGLMaterial.html#a4">Clear</a>();
01386             inProgress = 1;
01387             sscanf(next, <font class="stringliteral">"%s"</font>, tmat.Name);
01388           }
01389         <font class="keywordflow">else</font>
01390           <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"Ka"</font>))
01391             {
01392               sscanf(next, <font class="stringliteral">"%f %f %f"</font>, 
01393                      &amp;tmat.Ambient[0], 
01394                      &amp;tmat.Ambient[1], 
01395                      &amp;tmat.Ambient[2]);
01396               tmat.AmbientOn= 1;
01397             }
01398           <font class="keywordflow">else</font>
01399             <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"Kd"</font>))
01400               {
01401                 sscanf(next, <font class="stringliteral">"%f %f %f"</font>, 
01402                        &amp;tmat.Diffuse[0], 
01403                        &amp;tmat.Diffuse[1], 
01404                        &amp;tmat.Diffuse[2]);
01405                 tmat.Color[0] = tmat.Diffuse[0];
01406                 tmat.Color[1] = tmat.Diffuse[1];
01407                 tmat.Color[2] = tmat.Diffuse[2];
01408                 tmat.DiffuseOn = 1;
01409               }
01410             <font class="keywordflow">else</font>
01411               <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"Ks"</font>))
01412                 {
01413                   sscanf(next, <font class="stringliteral">"%f %f %f"</font>, 
01414                          &amp;tmat.Specular[0], 
01415                          &amp;tmat.Specular[1], 
01416                          &amp;tmat.Specular[2]);
01417                   tmat.SpecularOn = 1;
01418                 }
01419               <font class="keywordflow">else</font>
01420                 <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"Tr"</font>))
01421                   {
01422                     <font class="keywordtype">float</font> alpha = 1.0f;
01423                     sscanf(next, <font class="stringliteral">"%f"</font>, &amp;alpha);
01424                     tmat.Alpha = 1.0f - alpha;
01425                     tmat.AlphaOn = 1;
01426                   }
01427                 <font class="keywordflow">else</font>
01428                   <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"Ns"</font>))
01429                     {
01430                       sscanf(next, <font class="stringliteral">"%f"</font>, &amp;tmat.Shininess);
01431 
01432                       <font class="comment">/* clamp shininess range */</font>
01433                       <font class="keywordflow">if</font> (tmat.Shininess &lt;   0.0f)
01434                         tmat.Shininess =   0.0f;
01435                       <font class="keywordflow">else</font>
01436                         <font class="keywordflow">if</font> (tmat.Shininess &gt; 128.0f)
01437                           tmat.Shininess = 128.0f;
01438 
01439                       tmat.ShininessOn = 1;
01440                     }
01441                   <font class="keywordflow">else</font>
01442                     <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"map_Kd"</font>))
01443                       {
01444                         ParseTexture(next, &amp;tmat);                      
01445                         tmat.TextureOn = 1;
01446                       }
01447                     <font class="keywordflow">else</font>
01448                       <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"refl"</font>))
01449                         {
01450                           strcpy(tmat.Reflect, "sphere");
01451                           ParseTexture(next, &amp;tmat);
01452                           tmat.ReflectOn = 1;
01453                         }
01454                       <font class="keywordflow">else</font>
01455                         <font class="keywordflow">if</font> (
01456                             <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"Ni"</font>)           ||
01457                             <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"Tf"</font>)           ||
01458                             <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"bump"</font>)         ||
01459                             <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"d"</font>)            ||
01460                             <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"decal"</font>)        ||
01461                             <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"illum"</font>)        ||
01462                             <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"map_Ka"</font>)       ||
01463                             <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"map_Ks"</font>)       ||
01464                             <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"map_Ns"</font>)       ||
01465                             <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"map_d"</font>)        ||
01466                             <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"sharpness"</font>)    ||
01467                             <a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"vp"</font>))
01468                           {
01469                             numSkip++;
01470                           }
01471 <font class="preprocessor">#ifndef STRICT_OBJ_FORMAT
</font>01472 <font class="preprocessor"></font>        <font class="comment">/*
</font>01473 <font class="comment">         * indicate that this material is two-sided
</font>01474 <font class="comment">         */</font>
01475                         <font class="keywordflow">else</font>
01476                           <font class="keywordflow">if</font> (<a class="code" href="renderglobj_h.html#a58">SAME</a>(token, <font class="stringliteral">"TWOSIDE"</font>))
01477                             {
01478                               tmat.TwosideOn = 1;
01479                             }
01480 <font class="preprocessor">#endif
</font>01481 <font class="preprocessor"></font>                          <font class="keywordflow">else</font>
01482                             {
01483                               cout &lt;&lt; <font class="stringliteral">"unrecognized format"</font> &lt;&lt; endl;
01484                               numOther++;
01485                             }
01486     }
01487 
01488     <font class="keywordflow">if</font> (inProgress)
01489       AddMaterial(path, tmat);
01490     
01491     <font class="comment">/* close Wavefront ".mtl" file */</font>
01492     fclose(mtlFile);
01493 }
01494 
01495 
01496 
<a name="l01497"></a><a class="code" href="class_mslGLObject.html#a6">01497</a> <font class="keywordtype">int</font> <a class="code" href="class_mslGLObject.html#a6">mslGLObject::SetCurrentMaterialID</a>(<font class="keywordtype">char</font> * name)<font class="keyword">
</font>01498 <font class="keyword"></font>{
01499   <font class="keywordtype">int</font> i, id;
01500 
01501   id = -1;
01502   <font class="keywordflow">for</font>(i=0; i&lt;NumberOfMaterial; i++)
01503     {
01504       <font class="keywordflow">if</font>(strcmp(ObjectMaterialLib[i].Name, name) == 0)
01505         {
01506           id = ObjectMaterialLib[i].ID;
01507         }
01508     }
01509 
01510   <font class="keywordflow">return</font> id;    <font class="comment">// set to be not material</font>
01511   
01512 }
01513 
01514 
<a name="l01515"></a><a class="code" href="class_mslGLObject.html#a8">01515</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a8">mslGLObject::AddMaterial</a>(<font class="keyword">const</font> string&amp; path, <font class="keyword">const</font> <a class="code" href="class_mslGLMaterial.html">mslGLMaterial</a>&amp; mat)<font class="keyword">
</font>01516 <font class="keyword"></font>{
01517   <font class="keywordflow">if</font>(ObjectMaterialLib == NULL)
01518     {
01519       <font class="keywordflow">if</font>((ObjectMaterialLib = (<a class="code" href="class_mslGLMaterial.html">mslGLMaterial</a> *) malloc(<font class="keyword">sizeof</font>(<a class="code" href="class_mslGLMaterial.html">mslGLMaterial</a>))) == 0)
01520         {
01521           printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
01522           exit(-1);       
01523         }
01524     }
01525   <font class="keywordflow">else</font> 
01526     <font class="keywordflow">if</font>((ObjectMaterialLib = 
01527         (<a class="code" href="class_mslGLMaterial.html">mslGLMaterial</a> *) realloc(ObjectMaterialLib,
01528                                   <font class="keyword">sizeof</font>(<a class="code" href="class_mslGLMaterial.html">mslGLMaterial</a>)*(NumberOfMaterial+1))) == 0) 
01529       {
01530         printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
01531         exit(-1);
01532       }
01533 
01534   ObjectMaterialLib[NumberOfMaterial] = mat;
01535 
01536   ObjectMaterialLib[NumberOfMaterial].ID = NumberOfMaterial;
01537   ObjectMaterialLib[NumberOfMaterial].Shininess = mat.Shininess;
01538   <font class="keywordflow">if</font>(mat.TextureOn)
01539     ObjectMaterialLib[NumberOfMaterial].ImageLoad(NumberOfMaterial, path,  mat.TextureName);
01540 
01541   <font class="comment">//  ObjectMaterialLib[NumberOfMaterial].Print();</font>
01542 
01543   NumberOfMaterial++;
01544 }
01545 
01546 
<a name="l01547"></a><a class="code" href="class_mslGLObject.html#a9">01547</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a9">mslGLObject::AddFace</a>(<font class="keyword">const</font> <a class="code" href="class_mslGLFace.html">mslGLFace</a>&amp; face)<font class="keyword">
</font>01548 <font class="keyword"></font>{ 
01549   <font class="keywordflow">if</font>(ObjectFaceLib == NULL)
01550     {
01551       <font class="keywordflow">if</font>((ObjectFaceLib = (<a class="code" href="class_mslGLFace.html">mslGLFace</a> *) malloc(<font class="keyword">sizeof</font>(<a class="code" href="class_mslGLFace.html">mslGLFace</a>))) == 0)
01552         {
01553           printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
01554           exit(-1);       
01555         }
01556     }
01557   <font class="keywordflow">else</font> 
01558     <font class="keywordflow">if</font>((ObjectFaceLib = (<a class="code" href="class_mslGLFace.html">mslGLFace</a> *) realloc(ObjectFaceLib,
01559                                               <font class="keyword">sizeof</font>(<a class="code" href="class_mslGLFace.html">mslGLFace</a>)*(NumberOfFace+1))) == 0) {
01560       printf(<font class="stringliteral">"Error reallocating mem\n"</font>);
01561       exit(-1);
01562     }
01563   
01564   ObjectFaceLib[NumberOfFace] = face;
01565 
01566   NumberOfFace++;
01567 }
01568 
01569 
01570 <font class="comment">/*
</font>01571 <font class="comment"> * parse wafefront material file texture definition
</font>01572 <font class="comment"> */</font>
<a name="l01573"></a><a class="code" href="class_mslGLObject.html#a10">01573</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a10">mslGLObject::ParseTexture</a> (<font class="keywordtype">char</font> *next, <a class="code" href="class_mslGLMaterial.html">mslGLMaterial</a> *m)<font class="keyword">
</font>01574 <font class="keyword"></font>{
01575     <font class="keywordtype">int</font>          width = 0;
01576 
01577     <font class="comment">/* set default texture scale factors */</font>
01578     m-&gt;Su = 1.0f;
01579     m-&gt;Sv = 1.0f;
01580 
01581     <font class="comment">/* parse texture name */</font>
01582     sscanf(next, <font class="stringliteral">"%s%n"</font>, m-&gt;TextureName, &amp;width);
01583 
01584     <font class="comment">/* parse texture option strings */</font>
01585     <font class="keywordflow">do</font>
01586     {
01587         next += width;
01588 
01589         <font class="keywordflow">if</font> (strcmp(m-&gt;TextureName, "-mm") == 0)
01590             sscanf(next, <font class="stringliteral">"%f %f %s%n"</font>,     &amp;m-&gt;Su, &amp;m-&gt;Sv, m-&gt;TextureName, &amp;width);
01591         <font class="keywordflow">else</font>
01592         <font class="keywordflow">if</font> (strcmp(m-&gt;TextureName, "-s") == 0)
01593             sscanf(next, <font class="stringliteral">"%f %f %*f %s%n"</font>, &amp;m-&gt;Su, &amp;m-&gt;Sv, m-&gt;TextureName, &amp;width);
01594         <font class="keywordflow">else</font>
01595         <font class="keywordflow">if</font> (strcmp(m-&gt;TextureName, "-t") == 0)
01596             sscanf(next, <font class="stringliteral">"%f %f %*f %s%n"</font>, &amp;m-&gt;Su, &amp;m-&gt;Sv, m-&gt;TextureName, &amp;width);
01597         <font class="keywordflow">else</font>
01598         <font class="keywordflow">if</font> (strcmp(m-&gt;TextureName, "-type") == 0)
01599             sscanf(next, <font class="stringliteral">"%s %s%n"</font>, m-&gt;Reflect, m-&gt;TextureName, &amp;width);
01600         <font class="keywordflow">else</font>
01601             <font class="keywordflow">break</font>;
01602     } <font class="keywordflow">while</font> (1);   
01603 }
01604 
01605 
<a name="l01606"></a><a class="code" href="class_mslGLObject.html#a12">01606</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a12">mslGLObject::ObjectDraw</a>()<font class="keyword">
</font>01607 <font class="keyword"></font>{
01608   <font class="keywordtype">int</font> i;
01609   <font class="keywordtype">int</font> currentmat;
01610 
01611   glPushMatrix();
01612 
01613   glTranslatef(Position[0], Position[1], Position[2]);
01614   glRotatef(Orientation[2], 1.0, 0.0, 0.0);
01615   glRotatef(Orientation[1], 0.0, 1.0, 0.0);
01616   glRotatef(Orientation[0], 0.0, 0.0, 1.0);
01617   glScalef(Scale[0], Scale[1], Scale[2]);
01618 
01619   currentmat = ObjectFaceLib[0].MaterialID;
01620   <font class="keywordflow">if</font>(currentmat != -1)
01621     <a class="code" href="class_mslGLObject.html#a7">SetMaterial</a>(currentmat);
01622 
01623   <font class="keywordflow">for</font>(i=0; i&lt;NumberOfFace; i++)
01624     {
01625       <font class="keywordflow">if</font>(currentmat != ObjectFaceLib[i].MaterialID)
01626         {
01627           currentmat = ObjectFaceLib[i].MaterialID;
01628           <font class="keywordflow">if</font>(currentmat != -1)
01629             <a class="code" href="class_mslGLObject.html#a7">SetMaterial</a>(currentmat);
01630         }
01631 
01632       ObjectFaceLib[i].<a class="code" href="class_mslGLFace.html#a10">DrawFace</a>();
01633     }
01634   
01635   glPopMatrix();
01636 }
01637 
01638 
01639 
01640 
<a name="l01641"></a><a class="code" href="class_mslGLObject.html#a13">01641</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a13">mslGLObject::ObjectBoundingBoxDraw</a>()<font class="keyword">
</font>01642 <font class="keyword"></font>{
01643 
01644   glDisable(GL_TEXTURE_2D);
01645   glDisable(GL_LIGHTING);
01646 
01647   GLfloat Diffuse[] = {1.0, 0.0, 0.0};
01648   GLfloat Ambient[] = {1.0, 0.0, 0.0};
01649   GLfloat Specular[] = {1.0, 0.0, 0.0};
01650   GLfloat Shininess[] = {1.0, 0.0, 0.0};
01651 
01652   glPushMatrix();
01653 
01654   glTranslatef(Position[0], Position[1], Position[2]);
01655   glRotatef(Orientation[2], 1.0, 0.0, 0.0);
01656   glRotatef(Orientation[1], 0.0, 1.0, 0.0);
01657   glRotatef(Orientation[0], 0.0, 0.0, 1.0);
01658   glScalef(Scale[0], Scale[1], Scale[2]);
01659 
01660   glLineWidth(0.2);
01661 
01662   glColor4f(1.0, 0.0, 1.0, 1.0);
01663   glMaterialfv(GL_FRONT, GL_DIFFUSE, Diffuse);
01664   glMaterialfv(GL_FRONT, GL_AMBIENT, Ambient);
01665   glMaterialfv(GL_FRONT, GL_SPECULAR, Specular);
01666   glMaterialfv(GL_FRONT, GL_SHININESS, Shininess);
01667 
01668   glBegin(GL_LINES);
01669   
01670   glNormal3f(-1.0, -1.0, 1.0);
01671   glVertex3f(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01672   glNormal3f(1.0, -1.0, 1.0);
01673   glVertex3f(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01674 
01675   glNormal3f(-1.0, -1.0, 1.0);
01676   glVertex3f(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01677   glNormal3f(-1.0, 1.0, 1.0);
01678   glVertex3f(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01679 
01680   glNormal3f(1.0, 1.0, 1.0);
01681   glVertex3f(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01682   glNormal3f(-1.0, 1.0, 1.0);
01683   glVertex3f(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01684 
01685   glNormal3f(1.0, 1.0, 1.0);
01686   glVertex3f(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01687   glNormal3f(1.0, -1.0, 1.0);
01688   glVertex3f(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01689 
01690 
01691 
01692   glNormal3f(1.0, 1.0, -1.0);
01693   glVertex3f(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01694   glNormal3f(-1.0, 1.0, -1.0);
01695   glVertex3f(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01696 
01697   glNormal3f(1.0, 1.0, -1.0);
01698   glVertex3f(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01699   glNormal3f(1.0, -1.0, -1.0);
01700   glVertex3f(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01701 
01702   glNormal3f(-1.0, -1.0, -1.0);
01703   glVertex3f(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01704   glNormal3f(1.0, -1.0, -1.0);
01705   glVertex3f(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01706 
01707   glNormal3f(-1.0, -1.0, -1.0);
01708   glVertex3f(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01709   glNormal3f(-1.0, 1.0, -1.0);
01710   glVertex3f(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01711 
01712 
01713 
01714   glNormal3f(1.0, -1.0, 1.0);
01715   glVertex3f(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01716   glNormal3f(1.0, -1.0, -1.0);
01717   glVertex3f(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01718 
01719   glNormal3f(1.0, 1.0, -1.0);
01720   glVertex3f(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01721   glNormal3f(1.0, 1.0, 1.0);
01722   glVertex3f(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01723 
01724   glNormal3f(-1.0, 1.0, 1.0);
01725   glVertex3f(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01726   glNormal3f(-1.0, 1.0, -1.0);
01727   glVertex3f(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01728 
01729   glNormal3f(-1.0, -1.0, 1.0);
01730   glVertex3f(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01731   glNormal3f(-1.0, -1.0, 1.0);
01732   glVertex3f(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01733 
01734   glEnd();
01735   
01736   glPopMatrix();
01737   
01738   glLineWidth(1.0);
01739 
01740   glEnable(GL_TEXTURE_2D);
01741   glEnable(GL_LIGHTING);
01742 }
01743 
01744 
<a name="l01745"></a><a class="code" href="class_mslGLObject.html#a7">01745</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a7">mslGLObject::SetMaterial</a>(<font class="keywordtype">int</font> matindex)<font class="keyword">
</font>01746 <font class="keyword"></font>{
01747   ObjectMaterialLib[matindex].<a class="code" href="class_mslGLMaterial.html#a2">SetMaterial</a>();
01748 
01749   <font class="comment">//  ObjectMaterialLib[matindex].Print();</font>
01750 }
01751 
01752 
01753 
<a name="l01754"></a><a class="code" href="class_mslGLObject.html#a14">01754</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a14">mslGLObject::ObjectHighlight</a>()<font class="keyword">
</font>01755 <font class="keyword"></font>{
01756 
01757   glDisable(GL_TEXTURE_2D);
01758   glDisable(GL_LIGHTING);
01759 
01760   GLfloat Diffuse[] = {1.0, 0.0, 0.0};
01761   GLfloat Ambient[] = {1.0, 0.0, 0.0};
01762   GLfloat Specular[] = {1.0, 0.0, 0.0};
01763   GLfloat Shininess[] = {1.0, 0.0, 0.0};
01764 
01765   glPushMatrix();
01766 
01767   glTranslatef(Position[0], Position[1], Position[2]);
01768   glRotatef(Orientation[2], 1.0, 0.0, 0.0);
01769   glRotatef(Orientation[1], 0.0, 1.0, 0.0);
01770   glRotatef(Orientation[0], 0.0, 0.0, 1.0);
01771   glScalef(Scale[0], Scale[1], Scale[2]);
01772 
01773   glLineWidth(0.5);
01774 
01775   glColor4f(1.0, 1.0, 0.0, 1.0);
01776   glMaterialfv(GL_FRONT, GL_DIFFUSE, Diffuse);
01777   glMaterialfv(GL_FRONT, GL_AMBIENT, Ambient);
01778   glMaterialfv(GL_FRONT, GL_SPECULAR, Specular);
01779   glMaterialfv(GL_FRONT, GL_SHININESS, Shininess);
01780 
01781   glBegin(GL_LINES);
01782   
01783   glNormal3f(-1.0, -1.0, 1.0);
01784   glVertex3f(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01785   glNormal3f(1.0, -1.0, 1.0);
01786   glVertex3f(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01787 
01788   glNormal3f(-1.0, -1.0, 1.0);
01789   glVertex3f(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01790   glNormal3f(-1.0, 1.0, 1.0);
01791   glVertex3f(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01792 
01793   glNormal3f(1.0, 1.0, 1.0);
01794   glVertex3f(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01795   glNormal3f(-1.0, 1.0, 1.0);
01796   glVertex3f(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01797 
01798   glNormal3f(1.0, 1.0, 1.0);
01799   glVertex3f(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01800   glNormal3f(1.0, -1.0, 1.0);
01801   glVertex3f(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01802 
01803 
01804 
01805   glNormal3f(1.0, 1.0, -1.0);
01806   glVertex3f(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01807   glNormal3f(-1.0, 1.0, -1.0);
01808   glVertex3f(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01809 
01810   glNormal3f(1.0, 1.0, -1.0);
01811   glVertex3f(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01812   glNormal3f(1.0, -1.0, -1.0);
01813   glVertex3f(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01814 
01815   glNormal3f(-1.0, -1.0, -1.0);
01816   glVertex3f(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01817   glNormal3f(1.0, -1.0, -1.0);
01818   glVertex3f(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01819 
01820   glNormal3f(-1.0, -1.0, -1.0);
01821   glVertex3f(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01822   glNormal3f(-1.0, 1.0, -1.0);
01823   glVertex3f(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01824 
01825 
01826 
01827   glNormal3f(1.0, -1.0, 1.0);
01828   glVertex3f(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01829   glNormal3f(1.0, -1.0, -1.0);
01830   glVertex3f(BoundingBoxMax[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01831 
01832   glNormal3f(1.0, 1.0, -1.0);
01833   glVertex3f(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01834   glNormal3f(1.0, 1.0, 1.0);
01835   glVertex3f(BoundingBoxMax[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01836 
01837   glNormal3f(-1.0, 1.0, 1.0);
01838   glVertex3f(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMin[2]);
01839   glNormal3f(-1.0, 1.0, -1.0);
01840   glVertex3f(BoundingBoxMin[0], BoundingBoxMax[1], BoundingBoxMax[2]);
01841 
01842   glNormal3f(-1.0, -1.0, 1.0);
01843   glVertex3f(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMin[2]);
01844   glNormal3f(-1.0, -1.0, 1.0);
01845   glVertex3f(BoundingBoxMin[0], BoundingBoxMin[1], BoundingBoxMax[2]);
01846 
01847   glEnd();
01848   
01849   glPopMatrix();
01850   
01851   glLineWidth(1.0);
01852 
01853   glEnable(GL_TEXTURE_2D);
01854   glEnable(GL_LIGHTING);
01855 }
01856 
<a name="l01857"></a><a class="code" href="class_mslGLObject.html#a15">01857</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a15">mslGLObject::SetObjectPosition</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; pos)<font class="keyword">
</font>01858 <font class="keyword"></font>{
01859   Position[0] = pos[0];
01860   Position[1] = pos[1];
01861   Position[2] = pos[2];
01862 }
01863 
<a name="l01864"></a><a class="code" href="class_mslGLObject.html#a16">01864</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a16">mslGLObject::SetObjectOrientation</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; ori)<font class="keyword">
</font>01865 <font class="keyword"></font>{
01866   Orientation[0] = ori[0];
01867   Orientation[1] = ori[1];
01868   Orientation[2] = ori[2];
01869 }
01870 
<a name="l01871"></a><a class="code" href="class_mslGLObject.html#a17">01871</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a17">mslGLObject::SetObjectScale</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; sca)<font class="keyword">
</font>01872 <font class="keyword"></font>{
01873   Scale[0] = sca[0];
01874   Scale[1] = sca[1];
01875   Scale[2] = sca[2];
01876 }
01877 
01878 
<a name="l01879"></a><a class="code" href="class_mslGLObject.html#a18">01879</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a18">mslGLObject::SetBodyPositionChange</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; posc)<font class="keyword">
</font>01880 <font class="keyword"></font>{
01881   Position[0] = Position[0] + posc[0];
01882   Position[1] = Position[1] + posc[1];
01883   Position[2] = Position[2] + posc[2];
01884 }
01885 
01886 
<a name="l01887"></a><a class="code" href="class_mslGLObject.html#a19">01887</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a19">mslGLObject::SetBodyOrientationChange</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; oric)<font class="keyword">
</font>01888 <font class="keyword"></font>{
01889   Orientation[0] = Orientation[0] + oric[0];
01890   Orientation[1] = Orientation[1] + oric[1];
01891   Orientation[2] = Orientation[2] + oric[2];
01892 
01893   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0; i&lt;3; i++)
01894     {
01895       <font class="keywordflow">while</font>(Orientation[i]&gt;=2*PI) Orientation[i] = Orientation[i] - 360.0;
01896       <font class="keywordflow">while</font>(Orientation[i]&lt;0) Orientation[i] = Orientation[i] + 360.0;
01897     }
01898 }
01899 
<a name="l01900"></a><a class="code" href="class_mslGLObject.html#a20">01900</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a20">mslGLObject::SetBodyScaleChange</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; scac)<font class="keyword">
</font>01901 <font class="keyword"></font>{
01902   Scale[0] = Scale[0] * scac[0];
01903   Scale[1] = Scale[1] * scac[1];
01904   Scale[2] = Scale[2] * scac[2];
01905 }
01906 
01907 
<a name="l01908"></a><a class="code" href="class_mslGLObject.html#a21">01908</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a21">mslGLObject::PrintFace</a>()<font class="keyword">
</font>01909 <font class="keyword"></font>{
01910   <font class="keywordtype">int</font> i;
01911 
01912   cout &lt;&lt; <font class="stringliteral">"Name of Object: "</font> &lt;&lt; Name &lt;&lt; endl;
01913 
01914   cout &lt;&lt; <font class="stringliteral">"NumberOfFace: "</font> &lt;&lt; NumberOfFace &lt;&lt; endl;
01915 
01916   <font class="keywordflow">for</font>(i=0; i&lt;NumberOfFace; i++)
01917     {
01918       cout &lt;&lt; <font class="stringliteral">"face "</font> &lt;&lt; i &lt;&lt; <font class="stringliteral">":  "</font>;
01919       ObjectFaceLib[i].<a class="code" href="class_mslGLFace.html#a9">PrintVertex</a>();
01920     }
01921 }
01922 
<a name="l01923"></a><a class="code" href="class_mslGLObject.html#a22">01923</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a22">mslGLObject::PrintMaterial</a>()<font class="keyword">
</font>01924 <font class="keyword"></font>{
01925   <font class="keywordtype">int</font> i;
01926 
01927   <font class="keywordflow">for</font>(i=0; i&lt;NumberOfMaterial; i++)
01928     ObjectMaterialLib[i].<a class="code" href="class_mslGLMaterial.html#a5">Print</a>();
01929 }
01930 
01931 
<a name="l01932"></a><a class="code" href="class_mslGLObject.html#a23">01932</a> <font class="keywordtype">void</font> <a class="code" href="class_mslGLObject.html#a23">mslGLObject::PrintState</a>()<font class="keyword">
</font>01933 <font class="keyword"></font>{
01934   cout &lt;&lt; <font class="stringliteral">"Position: "</font> &lt;&lt; Position[0] 
01935        &lt;&lt; <font class="stringliteral">" "</font> &lt;&lt; Position[1]   
01936        &lt;&lt; <font class="stringliteral">" "</font> &lt;&lt; Position[2]  
01937        &lt;&lt; endl;
01938 
01939   cout &lt;&lt; <font class="stringliteral">"Orientation: "</font> &lt;&lt; Orientation[0] 
01940        &lt;&lt; <font class="stringliteral">" "</font> &lt;&lt; Orientation[1]   
01941        &lt;&lt; <font class="stringliteral">" "</font> &lt;&lt; Orientation[2]  
01942        &lt;&lt; endl;
01943 
01944   cout &lt;&lt; <font class="stringliteral">"Scale: "</font> &lt;&lt; Scale[0] 
01945        &lt;&lt; <font class="stringliteral">" "</font> &lt;&lt; Scale[1]   
01946        &lt;&lt; <font class="stringliteral">" "</font> &lt;&lt; Scale[2]  
01947        &lt;&lt; endl;
01948   
01949 }
01950 
01951 <font class="comment">//  !!!!!!!!!!!!!!!!!!!!!!!! -- come from generalfunctin.C -- 1/5/01</font>
01952 
<a name="l01953"></a><a class="code" href="renderglobj_C.html#a18">01953</a> mslGLNormal <a class="code" href="renderglobj_C.html#a18">NormalCompute</a>(<font class="keyword">const</font> mslGLVertex&amp; v1, <font class="keyword">const</font> mslGLVertex&amp; v2, 
01954                           <font class="keyword">const</font> mslGLVertex&amp; v3)<font class="keyword">
</font>01955 <font class="keyword"></font>{
01956   mslGLNormal n;
01957   <a class="code" href="class_MSLVector.html">MSLVector</a> vv1(3), vv2(3), vv(3);
01958 
01959   vv1[0] = v2.x - v1.x;
01960   vv1[1] = v2.y - v1.y;
01961   vv1[2] = v2.z - v1.z;
01962 
01963   vv2[0] = v3.x - v1.x;
01964   vv2[1] = v3.y - v1.y;
01965   vv2[2] = v3.z - v1.z;
01966 
01967   <a class="code" href="renderglobj_C.html#a10">crossproduct</a>(vv1, vv2, vv);
01968 
01969   n.x = vv[0];
01970   n.y = vv[1];
01971   n.z = vv[2];
01972 
01973   <font class="keywordflow">return</font> n;
01974 }
01975 
01976 <font class="comment">//  !!!!!!!!!!!!!!!!!!!!!!!! -- come from generalfunctin.C -- 1/5/01</font>
01977 
01978 
</div></pre><HEAD>
<TITLE>Motion Strategy Library</TITLE>
</HEAD>

<p>

<hr>

Web page maintained by 
<a href="http://janowiec.cs.iastate.edu/~lavalle">Steve LaValle</a><br>

Partial support provided by NSF CAREER Award IRI-970228 (LaValle),
Honda Research, and Iowa State University.<br>

Contributors:  Anna Atramentov, Peng Cheng, James Kuffner, Steve LaValle, and Libo Yang.<br>
