<HEAD>
<TITLE>Motion Strategy Library</TITLE>
</HEAD>

<body bgcolor="#ffffff">

<center><img src="msl.jpg"></center>

<p>


<!-- Generated by Doxygen 1.2.2 on Wed Aug 29 23:26:43 2001 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>matrix.C</h1><a href="matrix_C.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 <font class="preprocessor">#include "<a class="code" href="matrix_h.html">matrix.h</a>"</font>
00003 <font class="preprocessor">#include &lt;math.h&gt;</font>
00004 
<a name="l00005"></a><a class="code" href="matrix_C.html#a0">00005</a> <font class="preprocessor">#define EPSILON 1e-12
</font>00006 <font class="preprocessor"></font>
00007 
00008 <font class="keywordtype">void</font> MSLMatrix::flip_rows(<font class="keywordtype">int</font> i,<font class="keywordtype">int</font> j)<font class="keyword">
</font>00009 <font class="keyword"></font>{ <a class="code" href="class_MSLVector.html">MSLVector</a>* p = v[i];
00010   v[i] = v[j];
00011   v[j] = p;
00012  }
00013 
00014 
<a name="l00015"></a><a class="code" href="class_MSLMatrix.html#a0">00015</a> <a class="code" href="class_MSLMatrix.html#a0">MSLMatrix::MSLMatrix</a>(<font class="keywordtype">int</font> dim1, <font class="keywordtype">int</font> dim2)<font class="keyword">  
</font>00016 <font class="keyword"></font>{
00017   <font class="keywordflow">if</font> (dim1&lt;0 || dim2&lt;0) 
00018   error_handler(1,<font class="stringliteral">"MSLMatrix: negative dimension."</font>); 
00019 
00020   d1=dim1; 
00021   d2=dim2; 
00022 
00023   <font class="keywordflow">if</font> (d1 &gt; 0) 
00024   { v = <font class="keyword">new</font> <a class="code" href="class_MSLVector.html">MSLVector</a>*[d1];
00025     <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0;i&lt;d1;i++) v[i] = <font class="keyword">new</font> MSLVector(d2); 
00026    }
00027   <font class="keywordflow">else</font> v = NULL;
00028 }
00029 
00030 
<a name="l00031"></a><a class="code" href="class_MSLMatrix.html#a2">00031</a> <a class="code" href="class_MSLMatrix.html#a0">MSLMatrix::MSLMatrix</a>(<font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; p)<font class="keyword">  
</font>00032 <font class="keyword"></font>{ 
00033   d1 = p.d1;
00034   d2 = p.d2;
00035     
00036   <font class="keywordflow">if</font> (d1 &gt; 0) 
00037   { v = <font class="keyword">new</font> <a class="code" href="class_MSLVector.html">MSLVector</a>*[d1];
00038     <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0;i&lt;d1;i++) v[i] = <font class="keyword">new</font> MSLVector(*p.v[i]); 
00039    }
00040   <font class="keywordflow">else</font> v = NULL;
00041 }
00042 
<a name="l00043"></a><a class="code" href="class_MSLMatrix.html#a1">00043</a> <a class="code" href="class_MSLMatrix.html#a0">MSLMatrix::MSLMatrix</a>(<font class="keywordtype">int</font> dim1, <font class="keywordtype">int</font> dim2, <font class="keywordtype">double</font>* D)<font class="keyword">  
</font>00044 <font class="keyword"></font>{ d1=dim1; d2=dim2; 
00045   v = <font class="keyword">new</font> <a class="code" href="class_MSLVector.html">MSLVector</a>*[dim1];
00046   <font class="keywordtype">double</font>* p = D;
00047   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0;i&lt;dim1;i++) 
00048   { v[i] = <font class="keyword">new</font> MSLVector(dim2); 
00049     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j=0;j&lt;dim2;j++) elem(i,j) = *p++;
00050    }
00051 
00052  }
00053 
<a name="l00054"></a><a class="code" href="class_MSLMatrix.html#a5">00054</a> <a class="code" href="class_MSLMatrix.html#a5">MSLMatrix::~MSLMatrix</a>()<font class="keyword">  
</font>00055 <font class="keyword"></font>{ <font class="keywordflow">if</font> (v) 
00056   { <font class="keywordflow">while</font>(d1--) <font class="keyword">delete</font> v[d1]; 
00057     <font class="keyword">delete</font>[] v;
00058    }
00059 }
00060 
00061 
00062 <font class="keywordtype">void</font> MSLMatrix::check_dimensions(<font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; mat)<font class="keyword"> const
</font>00063 <font class="keyword"></font>{ <font class="keywordflow">if</font> (d1 != mat.d1 || d2 != mat.d2)
00064    error_handler(1,<font class="stringliteral">"incompatible MSLMatrix types."</font>);
00065  }
00066 
<a name="l00067"></a><a class="code" href="class_MSLMatrix.html#a3">00067</a> <a class="code" href="class_MSLMatrix.html#a0">MSLMatrix::MSLMatrix</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; vec)<font class="keyword">
</font>00068 <font class="keyword"></font>{ d1 = vec.d;
00069   d2 = 1;
00070   v = <font class="keyword">new</font> <a class="code" href="class_MSLVector.html">MSLVector</a>*[d1];
00071   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0; i&lt;d1; i++)
00072   { v[i] = <font class="keyword">new</font> MSLVector(1);
00073     elem(i,0) = vec[i];
00074    }
00075     
00076 }
00077 
<a name="l00078"></a><a class="code" href="class_MSLMatrix.html#a4">00078</a> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; <a class="code" href="class_MSLMatrix.html#a4">MSLMatrix::operator=</a>(<font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; mat)<font class="keyword">
</font>00079 <font class="keyword"></font>{ <font class="keyword">register</font> <font class="keywordtype">int</font> i,j;
00080 
00081   <font class="keywordflow">if</font> (d1 != mat.d1 || d2 != mat.d2)
00082   { <font class="keywordflow">for</font>(i=0;i&lt;d1;i++) <font class="keyword">delete</font> v[i];
00083     <font class="keyword">delete</font>[] v;
00084     d1 = mat.d1;
00085     d2 = mat.d2;
00086     v = <font class="keyword">new</font> <a class="code" href="class_MSLVector.html">MSLVector</a>*[d1];
00087     <font class="keywordflow">for</font>(i=0;i&lt;d1;i++) v[i] = <font class="keyword">new</font> MSLVector(d2);
00088    }
00089 
00090   <font class="keywordflow">for</font>(i=0;i&lt;d1;i++)
00091     <font class="keywordflow">for</font>(j=0;j&lt;d2;j++) elem(i,j) = mat.elem(i,j);
00092 
00093   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00094 }
00095 
<a name="l00096"></a><a class="code" href="class_MSLMatrix.html#a19">00096</a> <font class="keywordtype">int</font> <a class="code" href="class_MSLMatrix.html#a19">MSLMatrix::operator==</a>(<font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; x)<font class="keyword"> const
</font>00097 <font class="keyword"></font>{ <font class="keyword">register</font> <font class="keywordtype">int</font> i,j;
00098   <font class="keywordflow">if</font> (d1 != x.d1 || d2 != x.d2) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00099 
00100   <font class="keywordflow">for</font>(i=0;i&lt;d1;i++)
00101     <font class="keywordflow">for</font>(j=0;j&lt;d2;j++)
00102       <font class="keywordflow">if</font> (elem(i,j) != x.elem(i,j)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00103 
00104   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00105  }
00106 
00107 
<a name="l00108"></a><a class="code" href="class_MSLMatrix.html#a8">00108</a> <a class="code" href="class_MSLVector.html">MSLVector</a>&amp; <a class="code" href="class_MSLMatrix.html#a8">MSLMatrix::row</a>(<font class="keywordtype">int</font> i)<font class="keyword"> const
</font>00109 <font class="keyword"></font>{ <font class="keywordflow">if</font> ( i&lt;0 || i&gt;=d1 )  error_handler(1,<font class="stringliteral">"MSLMatrix: row index out of range"</font>);
00110    <font class="keywordflow">return</font> *v[i];
00111 }
00112 
00113 
<a name="l00114"></a><a class="code" href="class_MSLMatrix.html#a17">00114</a> <font class="keywordtype">double</font>&amp; <a class="code" href="class_MSLMatrix.html#a17">MSLMatrix::operator()</a>(<font class="keywordtype">int</font> i, <font class="keywordtype">int</font> j)<font class="keyword">
</font>00115 <font class="keyword"></font>{ <font class="keywordflow">if</font> ( i&lt;0 || i&gt;=d1 )  error_handler(1,<font class="stringliteral">"MSLMatrix: row index out of range"</font>);
00116   <font class="keywordflow">if</font> ( j&lt;0 || j&gt;=d2 )  error_handler(1,<font class="stringliteral">"MSLMatrix: col index out of range"</font>);
00117   <font class="keywordflow">return</font> elem(i,j);
00118 }
00119 
<a name="l00120"></a><a class="code" href="class_MSLMatrix.html#a18">00120</a> <font class="keywordtype">double</font> <a class="code" href="class_MSLMatrix.html#a17">MSLMatrix::operator()</a>(<font class="keywordtype">int</font> i, <font class="keywordtype">int</font> j)<font class="keyword"> const
</font>00121 <font class="keyword"></font>{ <font class="keywordflow">if</font> ( i&lt;0 || i&gt;=d1 )  error_handler(1,<font class="stringliteral">"MSLMatrix: row index out of range"</font>);
00122   <font class="keywordflow">if</font> ( j&lt;0 || j&gt;=d2 )  error_handler(1,<font class="stringliteral">"MSLMatrix: col index out of range"</font>);
00123   <font class="keywordflow">return</font> elem(i,j);
00124 }
00125 
<a name="l00126"></a><a class="code" href="class_MSLMatrix.html#a9">00126</a> <a class="code" href="class_MSLVector.html">MSLVector</a> <a class="code" href="class_MSLMatrix.html#a9">MSLMatrix::col</a>(<font class="keywordtype">int</font> i)  <font class="keyword">const</font>
00127 { <font class="keywordflow">if</font> ( i&lt;0 || i&gt;=d2 )  error_handler(1,<font class="stringliteral">"MSLMatrix: col index out of range"</font>);
00128   <a class="code" href="class_MSLVector.html">MSLVector</a> result(d1);
00129   <font class="keywordtype">int</font> j = d1;
00130   <font class="keywordflow">while</font> (j--) result.v[j] = elem(j,i);
00131   <font class="keywordflow">return</font> result;
00132 }
00133 
<a name="l00134"></a><a class="code" href="class_MSLMatrix.html#a15">00134</a> <a class="code" href="class_MSLMatrix.html#a15">MSLMatrix::operator MSLVector</a>()<font class="keyword"> const
</font>00135 <font class="keyword"></font>{ <font class="keywordflow">if</font> (d2!=1) 
00136    error_handler(1,<font class="stringliteral">"error: cannot make MSLVector from MSLMatrix\n"</font>);
00137   <font class="keywordflow">return</font> <a class="code" href="class_MSLMatrix.html#a9">col</a>(0);
00138 }
00139 
<a name="l00140"></a><a class="code" href="class_MSLMatrix.html#a21">00140</a> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> <a class="code" href="class_MSLMatrix.html#a21">MSLMatrix::operator+</a>(<font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; mat)<font class="keyword"> const
</font>00141 <font class="keyword"></font>{ <font class="keyword">register</font> <font class="keywordtype">int</font> i,j;
00142   check_dimensions(mat);
00143   <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> result(d1,d2);
00144   <font class="keywordflow">for</font>(i=0;i&lt;d1;i++)
00145    <font class="keywordflow">for</font>(j=0;j&lt;d2;j++)
00146       result.elem(i,j) = elem(i,j) + mat.elem(i,j);
00147   <font class="keywordflow">return</font> result;
00148 }
00149 
<a name="l00150"></a><a class="code" href="class_MSLMatrix.html#a25">00150</a> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; <a class="code" href="class_MSLMatrix.html#a25">MSLMatrix::operator+=</a>(<font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; mat)<font class="keyword"> 
</font>00151 <font class="keyword"></font>{ <font class="keyword">register</font> <font class="keywordtype">int</font> i,j;
00152   check_dimensions(mat);
00153   <font class="keywordflow">for</font>(i=0;i&lt;d1;i++)
00154    <font class="keywordflow">for</font>(j=0;j&lt;d2;j++)
00155       elem(i,j) += mat.elem(i,j);
00156   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00157 }
00158 
<a name="l00159"></a><a class="code" href="class_MSLMatrix.html#a24">00159</a> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; <a class="code" href="class_MSLMatrix.html#a24">MSLMatrix::operator-=</a>(<font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; mat)<font class="keyword"> 
</font>00160 <font class="keyword"></font>{ <font class="keyword">register</font> <font class="keywordtype">int</font> i,j;
00161   check_dimensions(mat);
00162   <font class="keywordflow">for</font>(i=0;i&lt;d1;i++)
00163    <font class="keywordflow">for</font>(j=0;j&lt;d2;j++)
00164       elem(i,j) -= mat.elem(i,j);
00165   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00166 }
00167 
00168 
<a name="l00169"></a><a class="code" href="class_MSLMatrix.html#a22">00169</a> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> <a class="code" href="class_MSLMatrix.html#a23">MSLMatrix::operator-</a>(<font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; mat)<font class="keyword"> const
</font>00170 <font class="keyword"></font>{ <font class="keyword">register</font> <font class="keywordtype">int</font> i,j;
00171   check_dimensions(mat);
00172   <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> result(d1,d2);
00173   <font class="keywordflow">for</font>(i=0;i&lt;d1;i++)
00174    <font class="keywordflow">for</font>(j=0;j&lt;d2;j++)
00175       result.elem(i,j) = elem(i,j) - mat.elem(i,j);
00176   <font class="keywordflow">return</font> result;
00177 }
00178 
00179 
<a name="l00180"></a><a class="code" href="class_MSLMatrix.html#a23">00180</a> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> <a class="code" href="class_MSLMatrix.html#a23">MSLMatrix::operator-</a>()  <font class="keyword">const</font>
00181 { <font class="keyword">register</font> <font class="keywordtype">int</font> i,j;
00182   <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> result(d1,d2);
00183   <font class="keywordflow">for</font>(i=0;i&lt;d1;i++)
00184    <font class="keywordflow">for</font>(j=0;j&lt;d2;j++)
00185       result.elem(i,j) = -elem(i,j);
00186   <font class="keywordflow">return</font> result;
00187 }
00188 
00189 
<a name="l00190"></a><a class="code" href="class_MSLMatrix.html#a28">00190</a> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> <a class="code" href="class_MSLMatrix.html#a26">MSLMatrix::operator*</a>(<font class="keywordtype">double</font> f)<font class="keyword"> const
</font>00191 <font class="keyword"></font>{ <font class="keyword">register</font> <font class="keywordtype">int</font> i,j;
00192   <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> result(d1,d2);
00193   <font class="keywordflow">for</font>(i=0;i&lt;d1;i++)
00194    <font class="keywordflow">for</font>(j=0;j&lt;d2;j++)
00195       result.elem(i,j) = elem(i,j) *f;
00196   <font class="keywordflow">return</font> result;
00197 }
00198 
<a name="l00199"></a><a class="code" href="class_MSLMatrix.html#a26">00199</a> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> <a class="code" href="class_MSLMatrix.html#a26">MSLMatrix::operator*</a>(<font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; mat)<font class="keyword"> const
</font>00200 <font class="keyword"></font>{ <font class="keywordflow">if</font> (d2!=mat.d1)
00201      error_handler(1,<font class="stringliteral">"MSLMatrix multiplication: incompatible MSLMatrix types\n"</font>);
00202   
00203   <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> result(d1, mat.d2);
00204   <font class="keyword">register</font> <font class="keywordtype">int</font> i,j;
00205 
00206   <font class="keywordflow">for</font> (i=0;i&lt;mat.d2;i++)
00207   <font class="keywordflow">for</font> (j=0;j&lt;d1;j++) result.elem(j,i) = *v[j] * mat.<a class="code" href="class_MSLMatrix.html#a9">col</a>(i);
00208 
00209  <font class="keywordflow">return</font> result;
00210 
00211 }
00212 
<a name="l00213"></a><a class="code" href="class_MSLMatrix.html#a12">00213</a> <font class="keywordtype">double</font> <a class="code" href="class_MSLMatrix.html#a12">MSLMatrix::det</a>()<font class="keyword"> const
</font>00214 <font class="keyword"></font>{
00215  <font class="keywordflow">if</font> (d1!=d2)  
00216    error_handler(1,<font class="stringliteral">"MSLMatrix::det: MSLMatrix not quadratic.\n"</font>);
00217 
00218  <font class="keywordtype">int</font> n = d1;
00219 
00220  <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> M(n,1);
00221 
00222  <font class="keywordtype">int</font> flips;
00223 
00224  <font class="keywordtype">double</font>** A = triang(M,flips);
00225 
00226  <font class="keywordflow">if</font> (A == NULL)  <font class="keywordflow">return</font> 0;
00227 
00228  <font class="keywordtype">double</font> Det = 1;
00229 
00230  <font class="keywordtype">int</font> i;
00231  <font class="keywordflow">for</font>(i=0;i&lt;n;i++) Det *= A[i][i];
00232  <font class="keywordflow">for</font>(i=0;i&lt;n;i++) <font class="keyword">delete</font>[] A[i];
00233  <font class="keyword">delete</font>[] A;
00234 
00235  <font class="keywordflow">return</font> (flips % 2) ? -Det : Det;
00236 
00237 }
00238 
00239 
00240 <font class="keywordtype">double</font>** MSLMatrix::triang(<font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; M, <font class="keywordtype">int</font>&amp; flips)  <font class="keyword">const</font>
00241 {
00242  <font class="keyword">register</font> <font class="keywordtype">double</font> **p, **q;
00243  <font class="keyword">register</font> <font class="keywordtype">double</font> *l, *r, *s;
00244 
00245  <font class="keyword">register</font> <font class="keywordtype">double</font> pivot_el,tmp;
00246 
00247  <font class="keyword">register</font> <font class="keywordtype">int</font> i,j, col, row;
00248 
00249  <font class="keywordtype">int</font> n = d1;
00250  <font class="keywordtype">int</font> d = M.d2;
00251  <font class="keywordtype">int</font> m = n+d;
00252 
00253  <font class="keywordtype">double</font>** A = <font class="keyword">new</font> <font class="keywordtype">double</font>*[n];
00254 
00255  p = A;
00256 
00257  <font class="keywordflow">for</font>(i=0;i&lt;n;i++) 
00258  { *p = <font class="keyword">new</font> <font class="keywordtype">double</font>[m];
00259    l = *p++;
00260    <font class="keywordflow">for</font>(j=0;j&lt;n;j++) *l++ = elem(i,j);
00261    <font class="keywordflow">for</font>(j=0;j&lt;d;j++) *l++ = M.elem(i,j);
00262   }
00263 
00264  flips = 0;
00265 
00266  <font class="keywordflow">for</font> (col=0, row=0; row&lt;n; row++, col++)
00267  { 
00268    <font class="comment">// search for row j with maximal absolute entry in current col</font>
00269    j = row;
00270    <font class="keywordflow">for</font> (i=row+1; i&lt;n; i++)
00271      <font class="keywordflow">if</font> (fabs(A[j][col]) &lt; fabs(A[i][col])) j = i;
00272 
00273    <font class="keywordflow">if</font> (row &lt; j) 
00274    { <font class="keywordtype">double</font>* p = A[j];
00275      A[j] = A[row];
00276      A[row] = p;
00277      flips++;
00278     }
00279 
00280    tmp = A[row][col];
00281    q  = &amp;A[row];
00282 
00283    <font class="keywordflow">if</font> (fabs(tmp) &lt; EPSILON) <font class="comment">// MSLMatrix has not full rank</font>
00284    { p = A;
00285      <font class="keywordflow">for</font>(i=0;i&lt;n;i++) <font class="keyword">delete</font> A[i];
00286      <font class="keyword">delete</font>[] A;
00287      <font class="keywordflow">return</font> NULL;
00288     }
00289 
00290    <font class="keywordflow">for</font> (p = &amp;A[n-1]; p != q; p--)
00291    { 
00292      l = *p+col;
00293      s = *p+m;  
00294      r = *q+col;
00295 
00296      <font class="keywordflow">if</font> (*l != 0.0)
00297      { pivot_el = *l/tmp;
00298         <font class="keywordflow">while</font>(l &lt; s) *l++ -= *r++ * pivot_el;
00299       }
00300 
00301     }
00302 
00303   }
00304 
00305  <font class="keywordflow">return</font> A;
00306 }
00307 
<a name="l00308"></a><a class="code" href="class_MSLMatrix.html#a11">00308</a> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> <a class="code" href="class_MSLMatrix.html#a11">MSLMatrix::inv</a>()<font class="keyword"> const
</font>00309 <font class="keyword"></font>{
00310  <font class="keywordflow">if</font> (d1!=d2)  
00311      error_handler(1,<font class="stringliteral">"MSLMatrix::inv: MSLMatrix not quadratic.\n"</font>);
00312  <font class="keywordtype">int</font> n = d1;
00313  <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> I(n,n);
00314  <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0; i&lt;n; i++) I(i,i) = 1;
00315  <font class="keywordflow">return</font> <a class="code" href="class_MSLMatrix.html#a13">solve</a>(I);
00316 }
00317 
00318 
00319 
<a name="l00320"></a><a class="code" href="class_MSLMatrix.html#a13">00320</a> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> <a class="code" href="class_MSLMatrix.html#a13">MSLMatrix::solve</a>(<font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; M)<font class="keyword"> const
</font>00321 <font class="keyword"></font>{
00322 
00323 <font class="keywordflow">if</font> (d1 != d2 || d1 != M.d1)
00324      error_handler(1, <font class="stringliteral">"Solve: wrong dimensions\n"</font>);
00325 
00326  <font class="keyword">register</font> <font class="keywordtype">double</font> **p, ** q;
00327  <font class="keyword">register</font> <font class="keywordtype">double</font> *l, *r, *s;
00328 
00329  <font class="keywordtype">int</font>      n = d1;
00330  <font class="keywordtype">int</font>      d = M.d2;
00331  <font class="keywordtype">int</font>      m = n+d;
00332  <font class="keywordtype">int</font>      row, col,i;
00333 
00334 
00335  <font class="keywordtype">double</font>** A = triang(M,i);
00336 
00337  <font class="keywordflow">if</font> (A == NULL) 
00338    error_handler(1,<font class="stringliteral">"MSLMatrix::solve: MSLMatrix has not full rank."</font>);
00339 
00340  <font class="keywordflow">for</font> (col = n-1, p = &amp;A[n-1]; col&gt;=0; p--, col--)
00341  { 
00342    s = *p+m;
00343 
00344    <font class="keywordtype">double</font> tmp = (*p)[col];
00345 
00346    <font class="keywordflow">for</font>(l=*p+n; l &lt; s; l++) *l /=tmp;
00347 
00348    <font class="keywordflow">for</font>(q = A; q != p; q++ )
00349    { tmp = (*q)[col];
00350      l = *q+n;
00351      r = *p+n;
00352      <font class="keywordflow">while</font>(r &lt; s)  *l++ -= *r++ * tmp;
00353     }
00354                  
00355   } 
00356 
00357   <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> result(n,d);
00358 
00359   <font class="keywordflow">for</font>(row=0; row&lt;n; row++)
00360   { l = A[row]+n;
00361     <font class="keywordflow">for</font>(col=0; col&lt;d; col++) result.elem(row,col) = *l++;
00362     <font class="keyword">delete</font>[] A[row];
00363    }
00364 
00365   <font class="keyword">delete</font>[] A;
00366 
00367   <font class="keywordflow">return</font> result;
00368 }
00369 
00370 
00371 
00372 
<a name="l00373"></a><a class="code" href="class_MSLMatrix.html#a10">00373</a> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> <a class="code" href="class_MSLMatrix.html#a10">MSLMatrix::trans</a>()<font class="keyword"> const
</font>00374 <font class="keyword"></font>{ <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> result(d2,d1);
00375   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = 0; i &lt; d2; i++)
00376     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j = 0; j &lt; d1; j++)
00377       result.elem(i,j) = elem(j,i);
00378   <font class="keywordflow">return</font> result;
00379 }
00380 
00381 
<a name="l00382"></a><a class="code" href="class_MSLMatrix.html#a29">00382</a> <font class="keywordtype">void</font> <a class="code" href="class_MSLMatrix.html#a30">MSLMatrix::read</a>(istream&amp; is)<font class="keyword">
</font>00383 <font class="keyword"></font>{ <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = 0; i &lt; d1; i++)
00384     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j = 0; j &lt; d2; j++)
00385         is &gt;&gt; elem(i,j);
00386  }
00387 
00388 
<a name="l00389"></a><a class="code" href="matrix_C.html#a1">00389</a> ostream&amp; <a class="code" href="vector_C.html#a5">operator&lt;&lt;</a>(ostream&amp; os, <font class="keyword">const</font> <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; M)<font class="keyword">
</font>00390 <font class="keyword"></font>{ os &lt;&lt; M.d1 &lt;&lt; <font class="stringliteral">" "</font> &lt;&lt; M.d2 &lt;&lt; endl;
00391   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = 0; i &lt; M.d1; i++)
00392   { <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j = 0; j &lt; M.d2; j++) os &lt;&lt; <font class="stringliteral">" "</font> &lt;&lt; M(i,j);
00393     os &lt;&lt; endl;
00394    }
00395   <font class="keywordflow">return</font> os;
00396 }
00397 
<a name="l00398"></a><a class="code" href="matrix_C.html#a2">00398</a> istream&amp; <a class="code" href="vector_C.html#a6">operator&gt;&gt;</a>(istream&amp; is, <a class="code" href="class_MSLMatrix.html">MSLMatrix</a>&amp; M)<font class="keyword">
</font>00399 <font class="keyword"></font>{ <font class="keywordtype">int</font> d1,d2;
00400   is &gt;&gt; d1 &gt;&gt; d2;
00401   <a class="code" href="class_MSLMatrix.html">MSLMatrix</a> MM(d1,d2);
00402   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = 0; i &lt; d1; i++)
00403     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j = 0; j &lt; d2; j++) 
00404        is &gt;&gt; MM(i,j);
00405   M = MM;
00406   <font class="keywordflow">return</font> is;
00407 }
00408 
00409 
</div></pre><HEAD>
<TITLE>Motion Strategy Library</TITLE>
</HEAD>

<p>

<hr>

Web page maintained by 
<a href="http://janowiec.cs.iastate.edu/~lavalle">Steve LaValle</a><br>

Partial support provided by NSF CAREER Award IRI-970228 (LaValle),
Honda Research, and Iowa State University.<br>

Contributors:  Anna Atramentov, Peng Cheng, James Kuffner, Steve LaValle, and Libo Yang.<br>
