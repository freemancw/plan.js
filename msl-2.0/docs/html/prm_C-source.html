<HEAD>
<TITLE>Motion Strategy Library</TITLE>
</HEAD>

<body bgcolor="#ffffff">

<center><img src="msl.jpg"></center>

<p>


<!-- Generated by Doxygen 1.2.2 on Wed Aug 29 23:26:44 2001 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>prm.C</h1><a href="prm_C.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">//----------------------------------------------------------------------</font>
00002 <font class="comment">//               The Motion Strategy Library (MSL)</font>
00003 <font class="comment">//----------------------------------------------------------------------</font>
00004 <font class="comment">//</font>
00005 <font class="comment">// Copyright (c) 1998-2000 Iowa State University and Steve LaValle.  </font>
00006 <font class="comment">// All Rights Reserved.</font>
00007 <font class="comment">// </font>
00008 <font class="comment">// Permission to use, copy, and distribute this software and its </font>
00009 <font class="comment">// documentation is hereby granted free of charge, provided that </font>
00010 <font class="comment">// (1) it is not a component of a commercial product, and </font>
00011 <font class="comment">// (2) this notice appears in all copies of the software and</font>
00012 <font class="comment">//     related documentation. </font>
00013 <font class="comment">// </font>
00014 <font class="comment">// Iowa State University and the author make no representations</font>
00015 <font class="comment">// about the suitability or fitness of this software for any purpose.  </font>
00016 <font class="comment">// It is provided "as is" without express or implied warranty.</font>
00017 <font class="comment">//----------------------------------------------------------------------</font>
00018 
00019 <font class="preprocessor">#include &lt;math.h&gt;</font>
00020 <font class="preprocessor">#include &lt;stdio.h&gt;</font>
00021 
00022 <font class="preprocessor">#include "<a class="code" href="prm_h.html">prm.h</a>"</font>
00023 <font class="preprocessor">#include "<a class="code" href="defs_h.html">defs.h</a>"</font>
00024 
00025 
00026 <font class="comment">// These are used for quasi-random sampling</font>
00027 <font class="keyword">static</font> <font class="keywordtype">int</font> Primes[] = {2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,
00028                        61,67,71,73,79,83,89,97,101,103,107,109,113,127,
00029                        131,137,139,149,151,157,163,167,173};
00030 
00031 
00032 <font class="comment">// *********************************************************************</font>
00033 <font class="comment">// *********************************************************************</font>
00034 <font class="comment">// CLASS:     PRM base class</font>
00035 <font class="comment">// </font>
00036 <font class="comment">// *********************************************************************</font>
00037 <font class="comment">// *********************************************************************</font>
00038 
<a name="l00039"></a><a class="code" href="class_PRM.html#a0">00039</a> <a class="code" href="class_PRM.html#a0">PRM::PRM</a>(<a class="code" href="class_Problem.html">Problem</a> *problem): <a class="code" href="class_RoadmapPlanner.html">RoadmapPlanner</a>(problem) {
00040   MaxEdgesPerVertex = 20;
00041   MaxNeighbors = 20;
00042 
00043   <a class="code" href="defs_h.html#a6">READ_PARAMETER_OR_DEFAULT</a>(Radius,20.0);
00044 
00045   SatisfiedCount = 0;
00046   QuasiRandom = <a class="code" href="util_C.html#a6">is_file</a>(P-&gt;FilePath + "QuasiRandom");
00047 
00049   QuasiRandomHammersley = <font class="keyword">true</font>;
00050 
00051   <font class="keywordflow">if</font> (!Holonomic)
00052     cout &lt;&lt; <font class="stringliteral">"WARNING: Differential constraints will be ignored.\n"</font>;
00053 }
00054 
00055 
00056 
00057 
<a name="l00058"></a><a class="code" href="class_PRM.html#b0">00058</a> list&lt;MSLVertex*&gt; <a class="code" href="class_PRM.html#b0">PRM::NeighboringVertices</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a> &amp;x)<font class="keyword"> </font>{
00059   <font class="keywordtype">double</font> d;
00060   <a class="code" href="class_MSLVertex.html">MSLVertex</a> n;
00061   list&lt;MSLVertex*&gt; best_list,all_vertices;
00062   list&lt;MSLVertex*&gt;::iterator vi;
00063   <font class="keywordtype">int</font> k;
00064 
00065   all_vertices = Roadmap-&gt;Vertices();
00066 
00067   best_list.clear();
00068   k = 0;
00069   <a class="code" href="defs_h.html#a8">forall</a>(vi,all_vertices)<font class="keyword"> </font>{
00070     d = P-&gt;Metric((*vi)-&gt;State(),x);
00071     <font class="keywordflow">if</font> ((d &lt; Radius)&amp;&amp;(k &lt; MaxNeighbors)) {
00072       best_list.push_back(*vi);
00073       k++;  <font class="comment">// Count the number of attempted connections</font>
00074     }
00075   } 
00076   
00077   <font class="comment">//cout &lt;&lt; "Number of Neighbors: " &lt;&lt; best_list.size() &lt;&lt; "\n";</font>
00078 
00079   <font class="keywordflow">return</font> best_list;
00080 }
00081 
00082 
00083 
00084 
00085 <font class="comment">// This function essentially iterates Extend until it has to stop</font>
00086 
<a name="l00087"></a><a class="code" href="class_PRM.html#b1">00087</a> <font class="keywordtype">bool</font> <a class="code" href="class_PRM.html#b1">PRM::Connect</a>(<font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a> &amp;x1, <font class="keyword">const</font> <a class="code" href="class_MSLVector.html">MSLVector</a> &amp;x2, <a class="code" href="class_MSLVector.html">MSLVector</a> &amp;u_best)<font class="keyword"> </font>{
00088   <font class="keywordtype">double</font> a;
00089   <font class="keywordtype">int</font> k;
00090   <a class="code" href="class_MSLVector.html">MSLVector</a> x;
00091 
00092   k = (<font class="keywordtype">int</font>) (P-&gt;Metric(x1,x2) / StepSize);
00093 
00094   <font class="comment">//cout &lt;&lt; "metric: " &lt;&lt; P-&gt;Metric(x1,x2) &lt;&lt; </font>
00095   <font class="comment">//  "    stepsize: " &lt;&lt; StepSize &lt;&lt; "\n";</font>
00096 
00097   <font class="keywordflow">if</font> (k == 0)
00098     <font class="keywordflow">return</font> <font class="keyword">true</font>;
00099 
00100   <font class="keywordflow">for</font> (a = 1.0/(k+1); a &lt; 1.0; a += 1.0/(k+1) ) {
00101     x = P-&gt;InterpolateState(x1,x2,a);
00102     SatisfiedCount++;
00103     <font class="keywordflow">if</font> (!P-&gt;Satisfied(x))
00104       <font class="keywordflow">return</font> <font class="keyword">false</font>;
00105   }
00106 
00107   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00108 }
00109 
00110 
00111 
<a name="l00112"></a><a class="code" href="class_PRM.html#a2">00112</a> <font class="keywordtype">void</font> <a class="code" href="class_PRM.html#a2">PRM::Construct</a>()<font class="keyword">
</font>00113 <font class="keyword"></font>{
00114   <font class="keywordtype">int</font> i,k;
00115   <a class="code" href="class_MSLVector.html">MSLVector</a> u_best,nx;
00116   <a class="code" href="class_MSLVertex.html">MSLVertex</a> *nn;
00117   list&lt;MSLVertex*&gt; nhbrs;
00118   list&lt;MSLVertex*&gt;::iterator ni;
00119   
00120   <font class="keywordtype">float</font> t = <a class="code" href="util_C.html#a0">used_time</a>();
00121 
00122   <font class="keywordflow">if</font> (!Roadmap)
00123     Roadmap = <font class="keyword">new</font> MSLGraph();
00124 
00125   <font class="comment">// Set the step size</font>
00126   StepSize = P-&gt;Metric(P-&gt;InitialState,P-&gt;Integrate(P-&gt;InitialState,
00127              P-&gt;GetInputs(P-&gt;InitialState).front(),PlannerDeltaT));
00128 
00129   i = 0;
00130   <font class="keywordflow">while</font> (i &lt; NumNodes) {
00131     nx = <a class="code" href="class_PRM.html#b2">ChooseState</a>(i,NumNodes,P-&gt;InitialState.dim());
00132     SatisfiedCount++;
00133     i++;
00134     <font class="keywordflow">while</font> (!P-&gt;Satisfied(nx)) {
00135       nx = <a class="code" href="class_PRM.html#b2">ChooseState</a>(i,NumNodes,P-&gt;InitialState.dim());  
00136       SatisfiedCount++;
00137       i++;
00138       <font class="comment">// Keep trying until a good sample is found</font>
00139     }
00140     nhbrs = <a class="code" href="class_PRM.html#b0">NeighboringVertices</a>(nx);
00141     nn = Roadmap-&gt;AddVertex(nx);
00142 
00143     k = 0;
00144     <a class="code" href="defs_h.html#a8">forall</a>(ni,nhbrs)<font class="keyword"> </font>{
00145       <font class="keywordflow">if</font> (<a class="code" href="class_PRM.html#b1">Connect</a>((*ni)-&gt;State(),nx,u_best)) {
00146         Roadmap-&gt;AddEdge(nn,*ni,u_best,1.0);
00147         Roadmap-&gt;AddEdge(*ni,nn,-1.0*u_best,1.0);
00148         k++;
00149       }
00150       <font class="keywordflow">if</font> (k &gt; MaxEdgesPerVertex)
00151         <font class="keywordflow">break</font>;
00152     }
00153 
00154     <font class="keywordflow">if</font> (Roadmap-&gt;NumVertices() % 1000 == 0)
00155       cout &lt;&lt; Roadmap-&gt;NumVertices() &lt;&lt; <font class="stringliteral">" vertices in the PRM.\n"</font>;
00156   }
00157 
00158   <font class="comment">//MSLVertex_array&lt;int&gt; labels(G);</font>
00159   <font class="comment">//c = COMPONENTS(G,labels); // Compute connected components</font>
00160 
00161   <font class="comment">/* Show component sizes
</font>00162 <font class="comment">  int count;
</font>00163 <font class="comment">  for (i = 0; i &lt; c; i++) {
</font>00164 <font class="comment">    count = 0;
</font>00165 <font class="comment">    forall_MSLVertexs(n,G) {
</font>00166 <font class="comment">      if (labels[n] == i)
</font>00167 <font class="comment">        count++;
</font>00168 <font class="comment">    }
</font>00169 <font class="comment">    cout &lt;&lt; "Component " &lt;&lt; i &lt;&lt; " has " &lt;&lt; count &lt;&lt; " MSLVertexs.\n";
</font>00170 <font class="comment">  }
</font>00171 <font class="comment">  */</font>
00172 
00173   cout &lt;&lt; <font class="stringliteral">"PRM Vertices: "</font> &lt;&lt; Roadmap-&gt;NumVertices() &lt;&lt; 
00174     <font class="stringliteral">"  Edges: "</font> &lt;&lt; Roadmap-&gt;NumEdges() &lt;&lt;
00175     <font class="stringliteral">"  ColDet: "</font> &lt;&lt; SatisfiedCount;
00176   <font class="comment">//cout &lt;&lt;  "  Components: " &lt;&lt; c;</font>
00177   cout &lt;&lt; <font class="stringliteral">"\n"</font>;
00178 
00179   CumulativeConstructTime += ((<font class="keywordtype">double</font>)<a class="code" href="util_C.html#a0">used_time</a>(t));
00180   cout &lt;&lt; <font class="stringliteral">"Construct Time: "</font> &lt;&lt; CumulativeConstructTime &lt;&lt; <font class="stringliteral">"s\n"</font>; 
00181 
00182 }
00183 
00184 
00185 
<a name="l00186"></a><a class="code" href="class_PRM.html#a3">00186</a> <font class="keywordtype">bool</font> <a class="code" href="class_PRM.html#a3">PRM::Plan</a>()<font class="keyword">
</font>00187 <font class="keyword"></font>{    
00188   list&lt;MSLVertex*&gt; nlist;
00189   list&lt;MSLEdge*&gt; elist;
00190   <a class="code" href="class_MSLVertex.html">MSLVertex</a> *n,*ni,*ng,*nn,*n_best;
00191   <a class="code" href="class_MSLVector.html">MSLVector</a> u_best;
00192   <font class="keywordtype">bool</font> success;
00193   list&lt;MSLVertex*&gt; vpath;
00194   list&lt;MSLVertex*&gt;::iterator vi;
00195   list&lt;MSLEdge*&gt;::iterator ei;
00196   priority_queue&lt;MSLVertex*,vector&lt;MSLVertex*&gt;,<a class="code" href="class_MSLVertexGreater.html">MSLVertexGreater</a>&gt; Q;
00197   <font class="keywordtype">double</font> cost,mincost,time;
00198 
00199   <font class="keywordtype">float</font> t = <a class="code" href="util_C.html#a0">used_time</a>();
00200 
00201   <font class="keywordflow">if</font> (!Roadmap) {
00202     cout &lt;&lt; <font class="stringliteral">"Empty roadmap.  Run Construct before Plan.\n"</font>;
00203     <font class="keywordflow">return</font> <font class="keyword">false</font>;
00204   }
00205 
00206   <font class="comment">// Set the step size</font>
00207   StepSize = P-&gt;Metric(P-&gt;InitialState,P-&gt;Integrate(P-&gt;InitialState,
00208              P-&gt;GetInputs(P-&gt;InitialState).front(),PlannerDeltaT));
00209 
00210   <font class="comment">// Connect to the initial state</font>
00211   nlist = <a class="code" href="class_PRM.html#b0">NeighboringVertices</a>(P-&gt;InitialState);
00212 
00213   <font class="keywordflow">if</font> (nlist.size() == 0) {
00214     cout &lt;&lt; <font class="stringliteral">"No neighboring vertices to the Initial State\n"</font>;
00215     cout &lt;&lt; <font class="stringliteral">"Planning Time: "</font> &lt;&lt; ((<font class="keywordtype">double</font>)<a class="code" href="util_C.html#a0">used_time</a>(t)) &lt;&lt; <font class="stringliteral">"s\n"</font>; 
00216     <font class="keywordflow">return</font> <font class="keyword">false</font>;
00217   }
00218 
00219   vi = nlist.begin();
00220   <font class="keywordflow">while</font> ((!success) &amp;&amp; (vi != nlist.end())) {
00221     success = <a class="code" href="class_PRM.html#b1">Connect</a>(P-&gt;InitialState,(*vi)-&gt;State(),u_best);
00222     vi++;
00223   }
00224 
00225   <font class="keywordflow">if</font> (!success) {
00226     cout &lt;&lt; <font class="stringliteral">"Failure to connect to Initial State\n"</font>;
00227     cout &lt;&lt; <font class="stringliteral">"Planning Time: "</font> &lt;&lt; ((<font class="keywordtype">double</font>)<a class="code" href="util_C.html#a0">used_time</a>(t)) &lt;&lt; <font class="stringliteral">"s\n"</font>; 
00228     <font class="keywordflow">return</font> <font class="keyword">false</font>;
00229   }
00230 
00231   <font class="comment">// Make ni a new vertex in the PRM</font>
00232   n = *vi;
00233   ni = Roadmap-&gt;AddVertex(P-&gt;InitialState);
00234   Roadmap-&gt;AddEdge(n,ni,u_best,1.0);
00235   Roadmap-&gt;AddEdge(ni,n,-1.0*u_best,1.0);
00236 
00237   <font class="comment">// Connect to the goal state</font>
00238   nlist = <a class="code" href="class_PRM.html#b0">NeighboringVertices</a>(P-&gt;GoalState);
00239 
00240   <font class="keywordflow">if</font> (nlist.size() == 0) {
00241     cout &lt;&lt; <font class="stringliteral">"No neighboring vertices to the Goal State\n"</font>;
00242     cout &lt;&lt; <font class="stringliteral">"Planning Time: "</font> &lt;&lt; ((<font class="keywordtype">double</font>)<a class="code" href="util_C.html#a0">used_time</a>(t)) &lt;&lt; <font class="stringliteral">"s\n"</font>; 
00243     <font class="keywordflow">return</font> <font class="keyword">false</font>;
00244   }
00245 
00246   vi = nlist.begin();
00247   <font class="keywordflow">while</font> ((!success) &amp;&amp; (vi != nlist.end())) {
00248     success = <a class="code" href="class_PRM.html#b1">Connect</a>((*vi)-&gt;State(),P-&gt;GoalState,u_best);
00249     vi++;
00250   }
00251 
00252   <font class="keywordflow">if</font> (!success) {
00253     cout &lt;&lt; <font class="stringliteral">"Failure to connect to Goal State\n"</font>;
00254     cout &lt;&lt; <font class="stringliteral">"Planning Time: "</font> &lt;&lt; ((<font class="keywordtype">double</font>)<a class="code" href="util_C.html#a0">used_time</a>(t)) &lt;&lt; <font class="stringliteral">"s\n"</font>; 
00255     <font class="keywordflow">return</font> <font class="keyword">false</font>;
00256   }
00257 
00258   <font class="comment">// Make ng a new MSLVertex in the PRM</font>
00259   n = *vi;
00260   ng = Roadmap-&gt;AddVertex(P-&gt;GoalState);
00261   Roadmap-&gt;AddEdge(n,ng,u_best,1.0);
00262   Roadmap-&gt;AddEdge(ng,n,-1.0*u_best,1.0);
00263 
00264   <font class="comment">// Initialize for DP search (the original PRM used A^*)</font>
00265   ni-&gt;<a class="code" href="class_MSLVertex.html#a3">SetCost</a>(0.0);
00266   Q.push(ni);
00267   nlist = Roadmap-&gt;Vertices();
00268   <a class="code" href="defs_h.html#a8">forall</a>(vi,nlist)
00269     (*vi)-&gt;Unmark();
00270   ni-&gt;<a class="code" href="class_MSLVertex.html#a6">Mark</a>();
00271 
00272   <font class="comment">// Loop until Q is empty or goal is found</font>
00273   success = <font class="keyword">false</font>;
00274   <font class="keywordflow">while</font> ((!success)&amp;&amp;(!Q.empty())) {
00275     <font class="comment">// Remove smallest element</font>
00276     n = Q.top();
00277     cost = n-&gt;<a class="code" href="class_MSLVertex.html#a2">Cost</a>();
00278     Q.pop();
00279 
00280     <font class="comment">// Expand its unexplored neighbors</font>
00281     elist = n-&gt;<a class="code" href="class_MSLVertex.html#a1">Edges</a>();
00282     <a class="code" href="defs_h.html#a8">forall</a>(ei,elist)<font class="keyword"> </font>{
00283       nn = (*ei)-&gt;Target();
00284       <font class="keywordflow">if</font> (!nn-&gt;<a class="code" href="class_MSLVertex.html#a8">IsMarked</a>()) { <font class="comment">// If not yet visited</font>
00285         nn-&gt;<a class="code" href="class_MSLVertex.html#a6">Mark</a>();
00286         nn-&gt;<a class="code" href="class_MSLVertex.html#a3">SetCost</a>(cost+(*ei)-&gt;Cost());
00287         Q.push(nn);
00288       }
00289     }
00290   }
00291 
00292   CumulativePlanningTime += ((<font class="keywordtype">double</font>)<a class="code" href="util_C.html#a0">used_time</a>(t));
00293   cout &lt;&lt; <font class="stringliteral">"Planning Time: "</font> &lt;&lt; CumulativePlanningTime &lt;&lt; <font class="stringliteral">"s\n"</font>; 
00294 
00295   <font class="keywordflow">if</font> (ng-&gt;<a class="code" href="class_MSLVertex.html#a8">IsMarked</a>()) {
00296     <font class="comment">// Get the path</font>
00297     n = ng;
00298     <font class="keywordflow">while</font> (n != ni) {
00299       mincost = INFINITY;
00300       vpath.push_front(n);
00301       <font class="comment">// Pick neighboring vertex with lowest cost</font>
00302       elist = n-&gt;<a class="code" href="class_MSLVertex.html#a1">Edges</a>();
00303       <a class="code" href="defs_h.html#a8">forall</a>(ei,elist)<font class="keyword"> </font>{
00304         nn = (*ei)-&gt;Target();
00305         <font class="keywordflow">if</font> (nn-&gt;<a class="code" href="class_MSLVertex.html#a2">Cost</a>() &lt; mincost) {
00306           n_best = nn; 
00307           mincost = nn-&gt;<a class="code" href="class_MSLVertex.html#a2">Cost</a>();
00308         }
00309       }
00310       n = n_best;
00311     }
00312     vpath.push_front(ni);
00313   }
00314   <font class="keywordflow">else</font> {
00315     cout &lt;&lt; <font class="stringliteral">"  Failure to find a path in the graph.\n"</font>;
00316     <font class="keywordflow">return</font> <font class="keyword">false</font>;
00317   }
00318 
00319   <font class="comment">// Make the solution</font>
00320   Path.clear();
00321   TimeList.clear();
00322   time = 0.0;
00323   <a class="code" href="defs_h.html#a8">forall</a>(vi,vpath)<font class="keyword"> </font>{
00324     Path.push_back((*vi)-&gt;State());
00325     TimeList.push_back(time);
00326     time += 1.0;
00327   }
00328 
00329   cout &lt;&lt; <font class="stringliteral">"  Success\n"</font>;
00330 
00331   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00332 }
00333 
00334 
00335 
<a name="l00336"></a><a class="code" href="class_PRM.html#b2">00336</a> <a class="code" href="class_MSLVector.html">MSLVector</a> <a class="code" href="class_PRM.html#b2">PRM::ChooseState</a>(<font class="keywordtype">int</font> i, <font class="keywordtype">int</font> maxnum, <font class="keywordtype">int</font> dim)<font class="keyword"> </font>{
00337   <font class="keywordflow">if</font> (QuasiRandom) {
00338     <font class="keywordflow">if</font> (QuasiRandomHammersley)
00339       <font class="keywordflow">return</font> <a class="code" href="class_PRM.html#b3">QuasiRandomStateHammersley</a>(i,maxnum,dim);
00340     <font class="keywordflow">else</font>
00341       <font class="keywordflow">return</font> <a class="code" href="class_PRM.html#b4">QuasiRandomStateHalton</a>(i,dim);
00342   }
00343   <font class="keywordflow">else</font>
00344     <font class="keywordflow">return</font> <a class="code" href="class_Planner.html#b0">RandomState</a>();
00345 }
00346 
00347 
00348 
00349 
<a name="l00350"></a><a class="code" href="class_PRM.html#b3">00350</a> <a class="code" href="class_MSLVector.html">MSLVector</a> <a class="code" href="class_PRM.html#b3">PRM::QuasiRandomStateHammersley</a>(<font class="keywordtype">int</font> i, <font class="keywordtype">int</font> maxnum, <font class="keywordtype">int</font> dim)<font class="keyword"> </font>{
00351   <font class="keywordtype">int</font> j,k,r,ppow;
00352   <a class="code" href="class_MSLVector.html">MSLVector</a> qrx;
00353 
00354   <font class="keywordflow">if</font> (dim &gt; 30) {
00355     cout &lt;&lt; <font class="stringliteral">"ERROR: Dimension too high for quasi-random samples\n"</font>;
00356     exit(-1);
00357   }
00358 
00359   qrx = MSLVector(dim);
00360 
00361   k = i;
00362   
00363   qrx[0] = ((<font class="keywordtype">double</font>) k / maxnum) * (P-&gt;UpperState[0] - P-&gt;LowerState[0]);
00364   qrx[0] += P-&gt;LowerState[0];
00365   <font class="keywordflow">for</font> (j = 1; j &lt; dim; j++) {
00366     qrx[j] = 0.0;
00367     ppow = Primes[j-1];
00368     k = i;
00369     <font class="keywordflow">while</font> (k != 0) {
00370       r = k % Primes[j-1];
00371       k = (<font class="keywordtype">int</font>) (k / Primes[j-1]);
00372       qrx[j] += (<font class="keywordtype">double</font>) r / ppow;
00373       ppow *= Primes[j-1];
00374     }
00375     qrx[j] *= (P-&gt;UpperState[j] - P-&gt;LowerState[j]);
00376     qrx[j] += P-&gt;LowerState[j];
00377   }
00378 
00379   <font class="keywordflow">return</font> qrx;
00380 }
00381 
00382 
<a name="l00383"></a><a class="code" href="class_PRM.html#b4">00383</a> <a class="code" href="class_MSLVector.html">MSLVector</a> <a class="code" href="class_PRM.html#b4">PRM::QuasiRandomStateHalton</a>(<font class="keywordtype">int</font> i, <font class="keywordtype">int</font> dim)<font class="keyword"> </font>{
00384   <font class="keywordtype">int</font> j,k,r,ppow;
00385   <a class="code" href="class_MSLVector.html">MSLVector</a> qrx;
00386 
00387   <font class="keywordflow">if</font> (dim &gt; 30) {
00388     cout &lt;&lt; <font class="stringliteral">"ERROR: Dimension too high for quasi-random samples\n"</font>;
00389     exit(-1);
00390   }
00391 
00392   qrx = MSLVector(dim);
00393   k = i;
00394 
00395   <font class="keywordflow">for</font> (j = 0; j &lt; dim; j++) {
00396     qrx[j] = 0.0;
00397     ppow = Primes[j];
00398     k = i;
00399     <font class="keywordflow">while</font> (k != 0) {
00400       r = k % Primes[j];
00401       k = (<font class="keywordtype">int</font>) (k / Primes[j]);
00402       qrx[j] += (<font class="keywordtype">double</font>) r / ppow;
00403       ppow *= Primes[j];
00404     }
00405     qrx[j] *= (P-&gt;UpperState[j] - P-&gt;LowerState[j]);
00406     qrx[j] += P-&gt;LowerState[j];
00407   }
00408 
00409   <font class="keywordflow">return</font> qrx;
00410 }
00411 
</div></pre><HEAD>
<TITLE>Motion Strategy Library</TITLE>
</HEAD>

<p>

<hr>

Web page maintained by 
<a href="http://janowiec.cs.iastate.edu/~lavalle">Steve LaValle</a><br>

Partial support provided by NSF CAREER Award IRI-970228 (LaValle),
Honda Research, and Iowa State University.<br>

Contributors:  Anna Atramentov, Peng Cheng, James Kuffner, Steve LaValle, and Libo Yang.<br>
