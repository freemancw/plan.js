<HEAD>
<TITLE>Motion Strategy Library</TITLE>
</HEAD>

<body bgcolor="#ffffff">

<center><img src="msl.jpg"></center>

<p>


<!-- Generated by Doxygen 1.2.2 on Wed Aug 29 23:26:44 2001 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>random.C</h1><a href="random_C.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="preprocessor">#include "<a class="code" href="random_h.html">random.h</a>"</font>
00002 <font class="preprocessor">#include &lt;time.h&gt;</font>
00003 
00004 
00005 <font class="keywordtype">void</font> MSLRandomSource::init_table()<font class="keyword">
</font>00006 <font class="keyword"></font>{ 
00007   table[ 0] = -1708027847;
00008   table[ 1] =   853131300;
00009   table[ 2] = -1687801470;
00010   table[ 3] =  1570894658;
00011   table[ 4] =  -566525472;
00012   table[ 5] =  -552964171;
00013   table[ 6] =  -251413502;
00014   table[ 7] =  1223901435;
00015   table[ 8] =  1950999915;
00016   table[ 9] = -1095640144;
00017   table[10] = -1420011240;
00018   table[11] = -1805298435;
00019   table[12] = -1943115761;
00020   table[13] =  -348292705;
00021   table[14] = -1323376457;
00022   table[15] =   759393158;
00023   table[16] =  -630772182;
00024   table[17] =   361286280;
00025   table[18] =  -479628451;
00026   table[19] = -1873857033;
00027   table[20] =  -686452778;
00028   table[21] =  1873211473;
00029   table[22] =  1634626454;
00030   table[23] = -1399525412;
00031   table[24] =   910245779;
00032   table[25] =  -970800488;
00033   table[26] =  -173790536;
00034   table[27] = -1970743429;
00035   table[28] =  -173171442;
00036   table[29] = -1986452981;
00037   table[30] =   670779321;
00038 
00039   ptr0    = table;
00040   ptr1    = table + 3;
00041   ptr_end = table + 31;
00042 }
00043 
00044 
<a name="l00045"></a><a class="code" href="class_MSLRandomSource.html#a6">00045</a> <font class="keywordtype">void</font> <a class="code" href="class_MSLRandomSource.html#a6">MSLRandomSource::set_seed</a>(<font class="keywordtype">int</font> x)<font class="keyword">
</font>00046 <font class="keyword"></font>{ table[0] = (<font class="keywordtype">unsigned</font>)x;
00047   <font class="keywordtype">int</font> i;
00048   <font class="keywordflow">for</font>(i=1; i&lt;31; i++) table[i] = 1103515245 * table[i-1] + 12345;
00049   ptr0 = table;
00050   ptr1 = table + 3;
00051   <font class="keywordflow">for</font>(i=0; i&lt;310; i++) <a class="code" href="class_MSLRandomSource.html#a0">get_rand31</a>();
00052 }
00053 
00054 
<a name="l00055"></a><a class="code" href="random_C.html#a0">00055</a> <font class="preprocessor">#define RANDMAX 0x7FFFFFFF
</font>00056 <font class="preprocessor"></font>
<a name="l00057"></a><a class="code" href="class_MSLRandomSource.html#a0">00057</a> <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> <a class="code" href="class_MSLRandomSource.html#a0">MSLRandomSource::get_rand31</a>()<font class="keyword">
</font>00058 <font class="keyword"></font>{ *ptr1 += *ptr0;
00059   <font class="keywordtype">long</font> i = (*ptr1 &gt;&gt; 1) &amp; 0x7fffffff;
00060   <font class="keywordflow">if</font> (++ptr0 &gt;= ptr_end) ptr0 = table;
00061   <font class="keywordflow">if</font> (++ptr1 &gt;= ptr_end) ptr1 = table;
00062   <font class="keywordflow">return</font> (<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font>)i;
00063 }
00064 
<a name="l00065"></a><a class="code" href="class_MSLRandomSource.html#a1">00065</a> <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> <a class="code" href="class_MSLRandomSource.html#a1">MSLRandomSource::get_rand32</a>()<font class="keyword">
</font>00066 <font class="keyword"></font>{ <font class="keywordflow">if</font> (buffer == 0x00000001) buffer = 0x80000000 | <a class="code" href="class_MSLRandomSource.html#a0">get_rand31</a>();
00067   <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> result = <a class="code" href="class_MSLRandomSource.html#a0">get_rand31</a>();
00068   <font class="keywordflow">if</font> (buffer&amp;1) result |= 0x80000000;
00069   buffer &gt;&gt;= 1;
00070   <font class="keywordflow">return</font> result;
00071 }
00072 
00073 
00074 
00075 <font class="keywordtype">int</font> MSLRandomSource::count = 0;
00076 
<a name="l00077"></a><a class="code" href="class_MSLRandomSource.html#a2">00077</a> <a class="code" href="class_MSLRandomSource.html#a2">MSLRandomSource::MSLRandomSource</a>()<font class="keyword">
</font>00078 <font class="keyword"></font>{ init_table();
00079   time_t seed;
00080   time(&amp;seed);
00081   count++;
00082   <a class="code" href="class_MSLRandomSource.html#a6">set_seed</a>(<font class="keywordtype">int</font>(seed)*count);
00083   pat = 0xFFFFFFFF; 
00084   prec = 31;
00085   bit_mode = <font class="keyword">true</font>;
00086   low = diff = 0;
00087   buffer = 0x00000001;
00088  }
00089 
<a name="l00090"></a><a class="code" href="class_MSLRandomSource.html#a3">00090</a> <a class="code" href="class_MSLRandomSource.html#a2">MSLRandomSource::MSLRandomSource</a>(<font class="keywordtype">int</font> bits)<font class="keyword"> 
</font>00091 <font class="keyword"></font>{ init_table();
00092   time_t seed;
00093   time(&amp;seed);
00094   count++;
00095   <a class="code" href="class_MSLRandomSource.html#a6">set_seed</a>(<font class="keywordtype">int</font>(seed)*count);
00096   <font class="keywordflow">if</font> (bits &lt;= 0 || bits &gt;= 32)
00097      pat = 0xFFFFFFFF; 
00098   <font class="keywordflow">else</font>
00099      pat = (1 &lt;&lt; bits) - 1;
00100   prec = bits;
00101   bit_mode = <font class="keyword">true</font>;
00102   low = diff = 0;
00103   buffer = 0x00000001;
00104  }
00105 
<a name="l00106"></a><a class="code" href="class_MSLRandomSource.html#a7">00106</a> <font class="keywordtype">void</font> <a class="code" href="class_MSLRandomSource.html#a7">MSLRandomSource::set_range</a>(<font class="keywordtype">int</font> l, <font class="keywordtype">int</font> h)<font class="keyword">
</font>00107 <font class="keyword"></font>{ low  = l;
00108   diff = (h &lt; l) ? 0 : h-l;
00109   bit_mode = <font class="keyword">false</font>;
00110   pat = 1;
00111   <font class="keywordflow">while</font> (pat &lt;= unsigned(diff)) pat &lt;&lt;= 1;
00112   pat--;
00113  }
00114 
00115 
<a name="l00116"></a><a class="code" href="class_MSLRandomSource.html#a4">00116</a> <a class="code" href="class_MSLRandomSource.html#a2">MSLRandomSource::MSLRandomSource</a>(<font class="keywordtype">int</font> l, <font class="keywordtype">int</font> h)<font class="keyword"> 
</font>00117 <font class="keyword"></font>{ init_table();
00118   time_t seed;
00119   time(&amp;seed);
00120   count++;
00121   <a class="code" href="class_MSLRandomSource.html#a6">set_seed</a>(<font class="keywordtype">int</font>(seed)*count);
00122   <a class="code" href="class_MSLRandomSource.html#a7">set_range</a>(l,h);
00123   buffer = 0x00000001;
00124  }
00125 
00126 
<a name="l00127"></a><a class="code" href="class_MSLRandomSource.html#a8">00127</a> <font class="keywordtype">int</font> <a class="code" href="class_MSLRandomSource.html#a8">MSLRandomSource::set_precision</a>(<font class="keywordtype">int</font> bits)<font class="keyword"> 
</font>00128 <font class="keyword"></font>{ <font class="keywordtype">int</font> oldprec = prec;
00129   prec = bits;
00130   <font class="keywordflow">if</font> (0 &gt;= bits || bits &gt;= 32)
00131      pat = 0xFFFFFFFF; 
00132   <font class="keywordflow">else</font>
00133      pat = (1 &lt;&lt; bits) - 1;
00134   bit_mode = <font class="keyword">true</font>;
00135   <font class="keywordflow">return</font> oldprec;
00136  }
00137 
00138 
<a name="l00139"></a><a class="code" href="class_MSLRandomSource.html#a18">00139</a> <font class="keywordtype">int</font> <a class="code" href="class_MSLRandomSource.html#a18">MSLRandomSource::operator()</a>()<font class="keyword">
</font>00140 <font class="keyword"></font>{ <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> x =  <a class="code" href="class_MSLRandomSource.html#a0">get_rand31</a>() &amp; pat;
00141   <font class="keywordflow">if</font> (bit_mode)
00142      <font class="keywordflow">return</font> int(x);
00143   <font class="keywordflow">else</font>
00144     { <font class="keywordflow">while</font> (x &gt; unsigned(diff)) x = <a class="code" href="class_MSLRandomSource.html#a0">get_rand31</a>() &amp; pat;
00145       <font class="keywordflow">return</font> (<font class="keywordtype">int</font>)(low + x);
00146      }
00147  }
00148 
<a name="l00149"></a><a class="code" href="class_MSLRandomSource.html#a19">00149</a> <font class="keywordtype">int</font>  <a class="code" href="class_MSLRandomSource.html#a18">MSLRandomSource::operator()</a>(<font class="keywordtype">int</font> bits)<font class="keyword">
</font>00150 <font class="keyword"></font>{ <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> mask = (1&lt;&lt;bits) - 1;
00151   <font class="keywordtype">int</font> shift = 31 - bits;
00152   <font class="keywordflow">if</font> (shift &lt; 0) shift = 0;
00153   <font class="keywordflow">return</font> int((<a class="code" href="class_MSLRandomSource.html#a0">get_rand31</a>() &gt;&gt; shift) &amp; mask); 
00154 }
00155 
00156 
<a name="l00157"></a><a class="code" href="class_MSLRandomSource.html#a20">00157</a> <font class="keywordtype">int</font>  <a class="code" href="class_MSLRandomSource.html#a18">MSLRandomSource::operator()</a>(<font class="keywordtype">int</font> l, <font class="keywordtype">int</font> h)<font class="keyword">
</font>00158 <font class="keyword"></font>{ <font class="keywordflow">if</font> (h &lt; l) <font class="keywordflow">return</font> 0;
00159 
00160   <font class="keywordtype">int</font>  old_low = low;
00161   <font class="keywordtype">int</font>  old_diff = diff;
00162   <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font>  old_pat = pat;
00163   <font class="keywordtype">bool</font> old_bit_mode = bit_mode;
00164   
00165   <a class="code" href="class_MSLRandomSource.html#a7">set_range</a>(l,h);
00166   <font class="keywordtype">int</font> x  = <a class="code" href="class_MSLRandomSource.html#a18">operator()</a>();
00167 
00168   low = old_low; 
00169   diff = old_diff; 
00170   pat = old_pat; 
00171   bit_mode = old_bit_mode;
00172 
00173   <font class="keywordflow">return</font> x; 
00174 }
00175 
00176 
00177 
<a name="l00178"></a><a class="code" href="class_MSLRandomSource.html#a17">00178</a> <a class="code" href="class_MSLRandomSource.html">MSLRandomSource</a>&amp; <a class="code" href="class_MSLRandomSource.html#a10">MSLRandomSource::operator&gt;&gt;</a>(<font class="keywordtype">bool</font>&amp; x)<font class="keyword">
</font>00179 <font class="keyword"></font>{ x = (<a class="code" href="class_MSLRandomSource.html#a0">get_rand31</a>() &amp; (1&lt;&lt;16)) != 0;
00180   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00181  }
00182 
00183 <font class="preprocessor">#if defined(__HAS_BUILTIN_BOOL__)
</font>00184 <font class="preprocessor"></font><a class="code" href="class_MSLRandomSource.html">MSLRandomSource</a>&amp; <a class="code" href="class_MSLRandomSource.html#a10">MSLRandomSource::operator&gt;&gt;</a>(<font class="keywordtype">char</font>&amp; x)<font class="keyword">
</font>00185 <font class="keyword"></font>{ x = char(<font class="keyword">operator</font>()());
00186   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00187  }
00188 <font class="preprocessor">#endif
</font>00189 <font class="preprocessor"></font>
<a name="l00190"></a><a class="code" href="class_MSLRandomSource.html#a11">00190</a> <a class="code" href="class_MSLRandomSource.html">MSLRandomSource</a>&amp; <a class="code" href="class_MSLRandomSource.html#a10">MSLRandomSource::operator&gt;&gt;</a>(<font class="keywordtype">int</font>&amp; x)<font class="keyword">      
</font>00191 <font class="keyword"></font>{ x = int(<font class="keyword">operator</font>()());
00192   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00193 }
00194 
<a name="l00195"></a><a class="code" href="class_MSLRandomSource.html#a12">00195</a> <a class="code" href="class_MSLRandomSource.html">MSLRandomSource</a>&amp; <a class="code" href="class_MSLRandomSource.html#a10">MSLRandomSource::operator&gt;&gt;</a>(<font class="keywordtype">long</font>&amp; x)<font class="keyword">      
</font>00196 <font class="keyword"></font>{ x = long(<font class="keyword">operator</font>()());
00197   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00198 }
00199 
00200 
00201 
<a name="l00202"></a><a class="code" href="class_MSLRandomSource.html#a10">00202</a> <a class="code" href="class_MSLRandomSource.html">MSLRandomSource</a>&amp; <a class="code" href="class_MSLRandomSource.html#a10">MSLRandomSource::operator&gt;&gt;</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>&amp; x)<font class="keyword">
</font>00203 <font class="keyword"></font>{ x = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>)(<a class="code" href="class_MSLRandomSource.html#a18">operator()</a>());
00204   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00205 }
00206 
00207 
<a name="l00208"></a><a class="code" href="class_MSLRandomSource.html#a13">00208</a> <a class="code" href="class_MSLRandomSource.html">MSLRandomSource</a>&amp; <a class="code" href="class_MSLRandomSource.html#a10">MSLRandomSource::operator&gt;&gt;</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>&amp; x)<font class="keyword">
</font>00209 <font class="keyword"></font>{ x = (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>)(<a class="code" href="class_MSLRandomSource.html#a18">operator()</a>());
00210   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00211 }
00212 
<a name="l00213"></a><a class="code" href="class_MSLRandomSource.html#a14">00213</a> <a class="code" href="class_MSLRandomSource.html">MSLRandomSource</a>&amp; <a class="code" href="class_MSLRandomSource.html#a10">MSLRandomSource::operator&gt;&gt;</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font>&amp; x)<font class="keyword">
</font>00214 <font class="keyword"></font>{ x = (<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font>)(<a class="code" href="class_MSLRandomSource.html#a18">operator()</a>());
00215   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00216 }
00217 
00218 
00219 
<a name="l00220"></a><a class="code" href="class_MSLRandomSource.html#a16">00220</a> <a class="code" href="class_MSLRandomSource.html">MSLRandomSource</a>&amp; <a class="code" href="class_MSLRandomSource.html#a10">MSLRandomSource::operator&gt;&gt;</a>(<font class="keywordtype">float</font>&amp;  x)<font class="keyword">
</font>00221 <font class="keyword"></font>{ x = float(<a class="code" href="class_MSLRandomSource.html#a0">get_rand31</a>())/RANDMAX; 
00222   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00223 }
00224 
00225 
00226 
<a name="l00227"></a><a class="code" href="class_MSLRandomSource.html#a15">00227</a> <a class="code" href="class_MSLRandomSource.html">MSLRandomSource</a>&amp; <a class="code" href="class_MSLRandomSource.html#a10">MSLRandomSource::operator&gt;&gt;</a>(<font class="keywordtype">double</font>&amp; x)<font class="keyword">
</font>00228 <font class="keyword"></font>{ x = double(<a class="code" href="class_MSLRandomSource.html#a0">get_rand31</a>())/RANDMAX; 
00229   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00230 }
00231 
00232 
</div></pre><HEAD>
<TITLE>Motion Strategy Library</TITLE>
</HEAD>

<p>

<hr>

Web page maintained by 
<a href="http://janowiec.cs.iastate.edu/~lavalle">Steve LaValle</a><br>

Partial support provided by NSF CAREER Award IRI-970228 (LaValle),
Honda Research, and Iowa State University.<br>

Contributors:  Anna Atramentov, Peng Cheng, James Kuffner, Steve LaValle, and Libo Yang.<br>
